import { useState, useRef, useEffect } from "react";
import { Link, useParams } from "react-router-dom";
import { Upload, Check, FileText, Eye, MessageSquare, Trash2, EyeOff, Pencil, Plus, X, ChevronDown } from "lucide-react";
import Header from "@/components/Header";
import Footer from "@/components/Footer";
import { Checkbox } from "@/components/ui/checkbox";
import { Dialog, DialogContent, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { useToast } from "@/hooks/use-toast";

// Types for the data structure
interface VerificationItem {
  id: string;
  text: string;
}

interface Indicator {
  id: string;
  title: string;
  items: VerificationItem[];
}

interface Criterion {
  id: string;
  number: number;
  name: string;
  indicators: Indicator[];
}

interface Course {
  slug: string;
  name: string;
  criteria: Criterion[];
}

// Evidence record type
interface EvidenceRecord {
  id: string;
  indicatorId: string;
  itemId: string;
  itemLabel: string;
  fileName: string;
  uploadedAt: string;
  status: string;
  hidden: boolean;
}

// Improvement task type
interface ImprovementTask {
  id: string;
  indicatorId: string;
  type: "آلي" | "يدوي";
  taskText: string;
  date: string;
  assignee: string;
  status: "تحت التنفيذ" | "تم";
  isAuto: boolean;
}

// Note record type
interface NoteRecord {
  id: string;
  indicatorId: string;
  text: string;
  date: string;
  source: "المنظمة" | "المراجعة";
}

// Course data with placeholders
const coursesData: Course[] = [
  {
    slug: "altawajuh",
    name: "التوجه",
    criteria: [
      {
        id: "c1",
        number: 1,
        name: "المعيار الأول: تحليل السياق",
        indicators: [
          {
            id: "i1",
            title: "المؤشر الأول: تجمع المنظمة بانتظام معلومات عن احتياجات المستفيدين وتوقعاتهم من البرامج والخدمات، وتقوم بتحليلها والاستفادة من نتائجها.",
            items: [
              { id: "item1", text: "لدى الجمعية نظام لجمع البيانات بانتظام مثل استبيانات أو لقاءات مخططة مع المستفيدين." },
              { id: "item2", text: "قامت الجمعية بجمع معلومات عن احتياجات المستفيدين وتوقعاتهم." },
              { id: "item3", text: "حللت الجمعية البيانات لتحديد توقعات المستفيدين ومدى رضاهم." },
              { id: "item4", text: "لدى الجمعية تقرير أو سجل موثق عن توقعات واحتياجات المستفيدين." },
              { id: "item5", text: "التقرير أو السجل حديث ومتاح." },
              { id: "item6", text: "تمت مناقشة التقرير ويوجد توثيق للمناقشة مثل محضر اجتماع أو تقرير ورشة عمل داخلية." },
              { id: "item7", text: "استخدمت الجمعية المعلومات في تحسين وتطوير البرامج والخدمات ويوجد دليل موثق يظهر ذلك." },
            ],
          },
          {
            id: "i2",
            title: "المؤشر الثاني: تملك المنظمة سجلاً موثقاً بالقوانين والأنظمة المتعلقة بالمستفيدين والخدمات، وتستطيع شرح تأثيرها على برامجها وخدماتها.",
            items: [
              { id: "item2-1", text: "البند الأول: تستخدم الجمعية سجلاً موثقاً بالقوانين والأنظمة المتعلقة بالمستفيدين والخدمات." },
              { id: "item2-2", text: "البند الثاني: السجل شامل لكل الأنظمة والقوانين ذات الصلة." },
              { id: "item2-3", text: "البند الثالث: حللت الجمعية تأثير الأنظمة والقوانين على خدماتها وهذا التحليل موثق في السجل." },
              { id: "item2-4", text: "البند الرابع: جميع العاملين أو المتطوعين ذوي العلاقة لديهم وعي بالقوانين والأنظمة ذات الصلة." },
              { id: "item2-5", text: "البند الخامس: سجل القوانين والأنظمة محدث ومتاح." },
              { id: "item2-6", text: "البند السادس: السجل مراجع من جهة أو شخص مختص مثل محامي أو أخصائي الحوكمة والامتثال." },
            ],
          },
          {
            id: "i3",
            title: "المؤشر الثالث: تحلل المنظمة المتطلبات الفنية اللازمة للبرامج والخدمات، لتحديد معايير تقديمها والموارد الضرورية لتلبية احتياجات المستفيدين.",
            items: [
              { id: "item3-1", text: "البند الأول: لدى الجمعية آلية أوعملية لتحليل المتطلبات الفنية للبرامج والخدمات." },
              { id: "item3-2", text: "البند الثاني: يتضمن التحليل تحديد المتطلبات والموارد الضرورية لتقديم الخدمات." },
              { id: "item3-3", text: "البند الثالث: يتضمن التحليل تحديد معايير تقديم الخدمات." },
              { id: "item3-4", text: "البند الرابع: يتضمن التحليل الموارد البشرية والمؤهلات والخبرات المطلوبة." },
              { id: "item3-5", text: "البند الخامس: التحليل موثق ومتاح." },
              { id: "item3-6", text: "البند السادس: التحليل محدث ويغطي كل البرامج والخدمات." },
            ],
          },
          {
            id: "i4",
            title: "المؤشر الرابع: تُحدد المنظمة جميع الجهات المعنية بخدماتها وبرامجها، وتُحلل مدى تأثيرهم، وتدرس توقعاتهم واحتياجاتهم، وتضعها في الاعتبار عند التخطيط وتقديم الخدمات.",
            items: [
              { id: "item4-1", text: "البند الأول: تستخدم الجمعية منهجية لتحليل الجهات المعنية." },
              { id: "item4-2", text: "البند الثاني: حصرت الجمعية كافة الجهات المعنية بخدماتها وبرامجها." },
              { id: "item4-3", text: "البند الثالث: حللت الجمعية مدي تأثير كل جهة من الجهات ذات العلاقة." },
              { id: "item4-4", text: "البند الرابع: درست الجمعية توقعات واحتياجات الجهات ذات العلاقة." },
              { id: "item4-5", text: "البند الخامس: تحليل التأثير ودراسة التوقعات والاحتياجات موثق في سجل أو تقرير متاح." },
              { id: "item4-6", text: "البند السادس: سجلأو تقرير تحليل الجهات المعنية محدث." },
              { id: "item4-7", text: "البند السابع: استفادت الجمعية من تحليل الجهات المعنية عند التخطيط وتقديم الخدمات ويوجد دليل موثق يظهر ذلك مثل محضر اجتماع أو تقرير أو بريد إلكتروني." },
            ],
          },
          {
            id: "i5",
            title: "المؤشر الخامس: تجري المنظمة تقييماً سنوياً لقدرتها على تلبية متطلبات تقديم برامج وخدمات تُناسب احتياجات المستفيدين وتوقعات الجهات المعنية.",
            items: [
              { id: "item5-1", text: "البند الأول: اختارت الجمعية أو طورت أدوات لتقييم القدرات المؤسسية." },
              { id: "item5-2", text: "البند الثاني: لدى الجمعية خطة سنوية لتقييم القدرات تحدد مواعيد التقييم الذاتي أو الخارجي وقد يكون مضمناً في الخطة التشغيلية." },
              { id: "item5-3", text: "البند الثالث: نفذت الجمعية أو شاركت في تقييم للقدرات المؤسسية مرة واحدة على الأقل خلال العام." },
              { id: "item5-4", text: "البند الرابع: يوجد تقرير موثق لنتائج تقييم القدرات المؤسسية." },
              { id: "item5-5", text: "البند الخامس: يوجد خطة للتحسين والتطوير استناداً نتائج التقييم." },
              { id: "item5-6", text: "البند السادس: يتوفر دليل على متابعة تنفيذ أنشطة خطة التحسين والتطوير." },
            ],
          },
          {
            id: "i6",
            title: "المؤشر السادس: تُحلل المنظمة تقارير إنجاز البرامج والخدمات، وتستخدم الدروس المستفادة وآراء الجهات المعنية في تطويرها وتحسينها.",
            items: [
              { id: "item6-1", text: "البند الأول: تقوم الجمعية بتحلل تقارير إنجاز البرامج والخدمات." },
              { id: "item6-2", text: "البند الثاني: توثق الجمعية الدروس المستفادة وتحللها." },
              { id: "item6-3", text: "البند الثالث: توثق الجمعية آراء الجهات المعنية وتحللها." },
              { id: "item6-4", text: "البند الرابع: يتوفر تقريرأو سجل لتحليل التقارير والدروس المستفادة والجهات المعنية." },
              { id: "item6-5", text: "البند الخامس: التقرير محدّث ومتاح." },
              { id: "item6-6", text: "البند السادس: يوجد دليل موثق على الاستفادة من التحليل في تطوير وتحسين البرامج والخدمات." },
            ],
          },
        ],
      },
      {
        id: "c2",
        number: 2,
        name: "المعيار الثاني: تحديد الأهداف",
        indicators: [
          {
            id: "c2-i1",
            title: "المؤشر الأول: تملك المنظمة وصفاً واضحاً ودقيقاً وموثقاً  للفئات المستفيدة من برامجها وخدماتها وتحدد الخدمات المقدمة لكل فئة.",
            items: [
              { id: "c2-item1", text: "البند الأول: الفئات المستفيدة من خدمات الجمعية معرّفة مع تحديد الخصائص الأساسية لكل فئة." },
              { id: "c2-item2", text: "البند الثاني: الخدمات المقدمة من الجمعية لكل فئة من فئات المستفيدين محددة." },
              { id: "c2-item3", text: "البند الثالث: لدى الجمعية وثيقة محدثة تتضمن توصيف الفئات المستفيدة والخدمات المقدمة لكل فئة." },
              { id: "c2-item4", text: "البند الرابع: الوثيقة معتمدة وتاريخ الاعتماد مذكور في الوثيقة." },
              { id: "c2-item5", text: "البند الخامس: الوثيقة محدثة ومتاحة." },
            ],
          },
          { 
            id: "c2-i2",
            title: "المؤشر الثاني: تحدد المنظمة هيكلية برامجها وخدماتها بدقة، موضحة العلاقة بينها، لضمان التكامل والانسجام في تحقيق الأهداف المشتركة.",
            items: [
              { id: "c2-item1", text: "البند الأول: جميع البرامج والخدمات التي تقدمها الجمعية معرّفة بدقة." },
              { id: "c2-item2", text: "البند الثاني: العلاقة بين البرامج والخدمات وتأثيرها على بعضها محدد بوضوح." },
              { id: "c2-item3", text: "البند الثالث: يتوفر دليل موثق لهيكلة البرامج والخدمات." },
              { id: "c2-item4", text: "البند الرابع: وثيقة الدليل معتمدة وتاريخ الاعتماد مذكور في الوثيقة." },
              { id: "c2-item5", text: "البند الخامس: الوثيقة محدثة ومتاحة والوصول إليها سهل." },
            ],
          },
          {
            id: "c2-i3",
            title: "المؤشر الثالث: تطوّر المنظمة وصفاً شاملاً لكل برنامج/خدمة يتضمن معلومات عن أهدافه، والمخرجات والنتائج المتوقعة، والفئة المستهدفة.",
            items: [
              { id: "c2-item1", text: "البند الأول: يتوفر لدى الجمعية وثيقة وصف لكل برنامج و خدمة تقدمها." },
              { id: "c2-item2", text: "البند الثاني: تتضمن الوثيقة أهداف كل برنامج أو خدمة." },
              { id: "c2-item3", text: "البند الثالث: تتضمن الوثيقة تحديد النتائج المستهدفة والتي تذكر بوضوح التغيرات الإيجابية المتوقعة على المستفيدين." },
              { id: "c2-item4", text: "البند الرابع: تتضمن الوثيقة تحديد للأنشطة والمنتجات المباشرة لكل برنامج أو خدمة." },
              { id: "c2-item5", text: "البند الخامس: تتضمن الوثيقة تحديد الفئةأو الفئات المستفيدة من البرنامج أو الخدمة." },
              { id: "c2-item6", text: "البند السادس: تتضمن الوثيقة تحديداً للمخاطر ذات الصلة بالبرنامج أو الخدمة." },
              { id: "c2-item7", text: "البند السابع: تتضمن الوثيقة تحديداً لمؤشرات النجاح ذات الصلة بالبرنامج أو الخدمة." },
              { id: "c2-item8", text: "البند الثامن: تتضمن الوثيقة تحديداً للشركاء ذوي العلاقة وأدوارهم المرتبطة بالبرنامج أو الخدمة." },
              { id: "c2-item9", text: "البند التاسع: الوثيقة معتمدة ومحدثة ويظهر فيها تاريخ الاعتماد وآخر تحديث." },

            ],
          },
          {
            id: "c2-i4",
            title: "المؤشر الرابع: تتضمن وثائق وصف البرامج/الخدمات مؤشرات واقعية لقياس مدى تحقيق النتائج على المستفيدين وتحدد المسؤوليات وطريقة جمع البيانات لكل مؤشر.",
            items: [
              { id: "c2-item1", text: "البند الأول: تتضمن وثيقة وصف البرنامج أو الخدمة تحديداً لمؤشرات تقيس تحقق النتائج على المستفيدين." },
              { id: "c2-item2", text: "البند الثاني: يتوفر لكل مؤشراً تحديداً واضح للمسؤوليات ذات الصلة مثل المسؤولية عن جمع البيانات." },
              { id: "c2-item3", text: "البند الثالث: طريقة جمع البيانات محددة لكل مؤشر." },
              { id: "c2-item4", text: "البند الرابع: دورية وتكرارية جمع البيانات محددة لكل مؤشر." },
              { id: "c2-item5", text: "البند الخامس: المؤشرات معتمدة ويوجد توثيق يظهر تاريخ الاعتماد." },
              { id: "c2-item6", text: "البند السادس: المؤشرات محدثة ومتسقة مع البرامج والخدمات التي تقدمها الجمعية." },
            ],

          },
        ],
      },
      {
        id: "c3",
        number: 3,
        name: "المعيار الثالث: إدارة المخاطر",
        indicators: [
          {
            id: "c3-i1",
            title: "المؤشر الأول: تحدد المنظمة المخاطر التي قد تُؤثر على تقديم البرامج والخدمات وتحقيق النتائج، وتُقيّم مدى تأثير كل خطر.",
            items: [
              { id: "c3-item1", text: "البند الأول: المخاطر التي قد تؤثر على تحقيق نتائج كل برنامج أو خدمة محددة بوضوح." },
              { id: "c3-item2", text: "البند الثاني: تحديد المخاطر شامل ويغطي كل الجوانب المتعلقة بالبرنامج أو الخدمة على سبيل المثال تشغيلية وتقنية وموارد بشرية وغيرها." },
              { id: "c3-item3", text: "البند الثالث: يوجد تقييم لمستوى تأثير كل خطر." },
              { id: "c3-item4", text: "البند الرابع: يوجد توثيق لمشاركة أصحاب المصلحة في تحديد المخاطر." },
            ],
          },
          {
            id: "c3-i2",
            title: "المؤشر الثاني: تضع المنظمة خطة لإدارة المخاطر، وتُحدد إجراءاتٍ مناسبة لمنعها أو تقليل تأثيرها، وتُحدد المسؤول عن تنفيذ كل إجراء.",
            items: [
              { id: "c3-item1", text: "البند الأول: إجراءات التعامل مع كل خطر موثقة وواضحة." },
              { id: "c3-item2", text: "البند الثاني: الخطة تتضمن إجراءات لمنع حدوث الخطر أو تقليل تأثيره." },
              { id: "c3-item3", text: "البند الثالث: يوجد تحديد واضح للمسؤول عن تنفيذ إجراءات التعامل مع الخطر." },
              { id: "c3-item4", text: "البند الرابع: خطة إدارة المخاطر معتمدة ويظهر تاريخ الاعتماد وجهته." },
              { id: "c3-item5", text: "البند الخامس: خطة إدارة المخاطر محدثة ويظهر تاريخ آخر تحديث." },

            ],
          },
          {
            id: "c3-i3",
            title: "المؤشر الثالث: تراجع المنظمة إجراءات التعامل مع المخاطر باستمرار وتُحدّثها بناءً على نتائج المراجعة والتغيرات في بيئة العمل.",
            items: [
              { id: "c3-item1", text: "البند الأول: يوجد توثيق يظهر تخطيط الجمعية لمراجعة إجراءات التعامل مع المخاطر." },
              { id: "c3-item2", text: "البند الثاني: وجد توثيق يظهر تنفيذ الجمعية لمراجعة إجراءات التعامل مع المخاطر." },
              { id: "c3-item3", text: "البند الثالث: العاملين في الجمعية لديهم وعي بآخر تحديث على إجراءات التعامل مع المخاطر." },
            ],
          },
          
        ],
      },
    ],
  },
  {
    slug: "alfariq",
    name: "الفريق",
    criteria: [
      {
        id: "team-c1",
        number: 1,
        name: "المعيار الأول: تخطيط الموارد البشرية",
        indicators: [
          {
            id: "team1-i1",
            title: "المؤشر الأول: تصمم المنظمة هيكلاً تنظيماً يعزز قدرتها على تحقيق أهدافها الاستراتيجية، وتُجري تحليلاً دقيقاً وشاملاً لجميع عملياتها الرئيسية لضمان تحقيق الفاعلية والتوافق بين الهيكل التنظيمي وتلك العمليات.",
            items: [
              { id: "team-item1", text: "البند الأول: حددت الجمعية العمليات الرئيسية بشكل دقيق." },
              { id: "team-item2", text: "البند الثاني: طورت الجمعية هيكلاً تنظيمياً يحدد الأدوار والمسؤوليات بوضوح." },
              { id: "team-item3", text: "البند الثالث: الهيكل التنظيمي متسق ومتوافق مع العمليات الرئيسية." },
              { id: "team-item4", text: "البند الرابع: يوجد توثيق للهيكل التنظيمي وجميع العمليات الرئيسية بشكل واضح." },
              { id: "team-item5", text: "البند الخامس: وثائق الهيكل التنظيمي وجميع العمليات الرئيسية متاحة وسهلة الوصول لجميع الأطراف المعنية." },
              { id: "team-item6", text: "البند السادس: الهيكل التنظيمي معتمد ويظهر تاريخ الاعتماد وجهته." },

            ],
          },
          {
            id: "team1-i2",
            title: "المؤشر الثاني: تُراجع المنظمة هيكلها التنظيمي وتُحدّثه بشكل دوري، لمواكبة التغيرات في الأهداف والاستراتيجيات والمتطلبات.",
            items: [
              { id: "team-item1", text: "البند الأول: تنفذ الجمعية مراجعات دورية لتقييم كفاءة الهيكل التنظيمي وفعاليته." },
              { id: "team-item2", text: "البند الثاني: جميع التعديلات التي تُجرى على الهيكل التنظيمي موثقة بوضوح وتُتاح لجميع الأطراف ذات الصلة." },
              { id: "team-item3", text: "البند الثالث: يوجد دليل على مشاركة ذوي العلاقة في تحديث وتطوير الهيكل." },
              { id: "team-item4", text: "البند الرابع: الهيكل التنظيمي الحالي محدّث ويعكس واقع الجمعية." },
              { id: "team-item5", text: "البند الخامس: يظهر في وثيقة الهيكل التنظيمي تاريخ آخر تحديث ورقم الإصدار." },
            ],
          },
          {
            id: "team1-i3",
            title: "المؤشر الثالث: تُحدد المنظمة بوضوح الجدارات الفنية اللازمة لإنجاز مهام تنفيذ البرامج وتقديم الخدمات للمستفيدين.",
            items: [
              { id: "team-item1", text: "البند الأول: حددت الجمعية الجدارات الوظيفية المطلوبة لإنجاز مهام تنفيذ البرامج وتقديم الخدمات بدقة." },
              { id: "team-item2", text: "البند الثاني: تحديد الجدارات الوظيفية شامل ويغطي جميع الوظائف الفنية في الهيكل التنظيمي للجمعية." },
              { id: "team-item3", text: "البند الثالث: هناك توثيق للجدارات الوظيفية بوضوح في دليل للجدارات أو وثائق التوصيف الوظيفي أو أي وثيقة أخرى مناسبة." },
              { id: "team-item4", text: "البند الرابع: تراجع الجمعية الجدارات الوظيفية بشكل دوري لتتوافق مع التغيرات في البرامج والخدمات." },
              { id: "team-item5", text: "البند الخامس: وثيقة الجدارات محدثة ويظهر تاريخ آخر تحديث فيها." },
              { id: "team-item6", text: "البند السادس: وثيقة الجدارات الوظيفية متاحة لجميع الموظفين ذوي العلاقة." },
            ],
          },
          {
            id: "team1-i4",
            title: "المؤشر الرابع: تضع المنظمة توصيفات وظيفية لجميع الوظائف الفنية في هيكلها التنظيمي، وتضمن أن مهام ومسؤوليات كل وظيفة، ومتطلبات شغلها، تتوافق مع الأنظمة والمعايير المُعتمدة في مجال عملها.",
            items: [
              { id: "team-item1", text: "البند الأول: التوصيفات الوظيفية مكتوبة لجميع الوظائف الفنية في الهيكل التنظيمي." },
              { id: "team-item2", text: "البند الثاني: حُددت المهام والمسؤوليات لكل وظيفة بوضوح ودقة." },
              { id: "team-item3", text: "البند الثالث: حددت المؤهلات والخبرات اللازمة لشغل كل وظيفة فنية." },
              { id: "team-item4", text: "البند الرابع: التوصيفات الوظيفية متوافقة مع الأنظمة والمعايير المُعتمدة ذات العلاقة." },
              { id: "team-item5", text: "البند الخامس: التوصيفات الوظيفية متاحة للموظفين والمسؤولين للاطلاع عليها عند الحاجة." },
              { id: "team-item6", text: "البند السادس: تُراجع التوصيفات الوظيفية بانتظام لضمان استمرار توافقها مع التغيرات في الهيكل التنظيمي أو الأنظمة." },
              { id: "team-item7", text: "البند السابع: التوصيفات الوظيفية معتمدة ويمكن إظهار تاريخ الاعتماد." },
              { id: "team-item8", text: "البند الثامن: التوصيفات الوظيفية محدّثة ويظهر فيها تاريخ آخر تحديث." },

            ],
          },
          {
            id: "team1-i5",
            title: "المؤشر الخامس: ُخطط المنظمة لاحتياجاتها من الموظفين (عددًا وكفاءةً)، بما يتوافق مع حجم العمل والمعايير المُعتمدة في مجال عملها.",
            items: [
              { id: "team-item1", text: "البند الأول: حللت الجمعية حجم العمل الحالي والمتوقع لتحديد الاحتياجات الفعلية من الموظفين." },
              { id: "team-item2", text: "البند الثاني: حددت الجمعية الفجوات في احتياجاتها من الموظفين عددا ونوعا." },
              { id: "team-item3", text: "البند الثالث: لدى الجمعية خطة واضحة للتوظيف تشمل جدول زمني وأولويات وتحديد للتكاليف المتوقعة." },
              { id: "team-item4", text: "البند الرابع: خطة التوظيف محدّثة بشكل منتظم لمواكبة المستجدات." },
              { id: "team-item5", text: "البند الخامس: خطة التوظيف معتمدة ويظهر تاريخ وجهة الاعتماد." },
            ],
          },
        ],
      },
      {
        id: "team-c2",
        number: 1,
        name: "المعيار الثاني: إدارة الموارد البشرية",
        indicators: [
          {
            id: "team2-i1",
            title: "المؤشر الأول: لدى المنظمة عدد كافٍ من الموظفين والمتطوعين المؤهلين لتنفيذ البرامج والخدمات وتحقيق النتائج المرجوة.",
            items: [
              { id: "team-item1", text: "البند الأول: تتأكد الجمعية أن جميع البرامج والخدمات لديها الكادر البشري اللازم لتحقيق الأهداف." },
              { id: "team-item2", text: "البند الثاني: الكفاءات المطلوبة للموظفين والمتطوعين تتوافق مع المعايير المُعتمدة في مجال عمل المنظمة." },
              { id: "team-item3", text: "البند الثالث: يوجد سجل يوضح أعداد الموظفين أو المتطوعين لكل برنامج أو خدمة." },
              { id: "team-item4", text: "البند الرابع: يوجد تحليل لمناسبة أعداد الموظفين أو المتطوعين مع متطلبات تنفيذ البرامج وتقديم الخدمات." },
            ],
          },
          {
            id: "team2-i2",
            title: "المؤشر الثاني: تصمم المنظمة وتُنفذ برامج تهيئة وتوعية فعّالة للموظفين والمتطوعين، وتتأكد من فهمهم لمتطلبات تقديم الخدمات للمستفيدين والتواصل معهم والحفاظ على سلامتهم .",
            items: [
              { id: "team-item1", text: "البند الأول: صممت الجمعية برامج تهيئة شاملة للموظفين والمتطوعين تغطي المهام والمسؤوليات الأساسية." },
              { id: "team-item2", text: "البند الثاني: نفذت الجمعية برامج توعية فعّالة تعرّف الموظفين والمتطوعين بمعايير تقديم الخدمات والتواصل مع المستفيدين." },
              { id: "team-item3", text: "البند الثالث: تُدرج متطلبات السلامة وحماية المستفيدين في برامج التهيئة والتوعية." },
              { id: "team-item4", text: "البند الرابع: تدرب الجمعية الموظفين والمتطوعين على أساليب التواصل الفعّال مع المستفيدين." },
              { id: "team-item5", text: "البند الخامس: يتضمن البرنامج توعية الموظفين والمتطوعين بالأنظمة والمعايير المُعتمدة في مجال العمل." },
              { id: "team-item6", text: "البند السادس: تقيّم الجمعية فهم الموظفين والمتطوعين بعد إتمام برامج التهيئة والتوعية لضمان استيعابهم." },
              { id: "team-item7", text: "البند السابع: تراجع برامج التهيئة والتوعية بانتظام لضمان مواكبتها للتغيرات والاحتياجات الجديدة." },
              { id: "team-item8", text: "البند الثامن: توثق الجمعية برامج التهيئة والتوعية ومحتوياتها لضمان الاتساق في التنفيذ. \." },
            ],
          },
          {
            id: "team2-i3",
            title: "المؤشر الثالث: تُجري المنظمة تحليلاً دورياً لاحتياجات التعلّم والتطوير للموظفين والمتطوعين، وتخطط برامج التعلم والتطوير استناداً إلى نتائج التحليل.",
            items: [
              { id: "team-item1", text: "البند الأول: تنفذ الجمعية تحليلاً دورياً لاحتياجات التعلّم والتطوير للموظفين والمتطوعين." },
              { id: "team-item2", text: "البند الثاني: تصمم الجمعية برامج تعلم وتطوير بناءً على نتائج التحليل لتلبية الاحتياجات المحددة." },
              { id: "team-item3", text: "البند الثالث: يوجد خطة موثقة لبرامج التعلّم والتطوير للموظفين والمتطوعين." },
              { id: "team-item4", text: "البند الرابع: تحدد الخطة البرامج التدريبية وبرامج التعلّم لجميع الموظفين والمتطوعين." },
              { id: "team-item5", text: "البند الخامس: تتضمن الخطة تحديداً للموارد المطلوبة والتكاليف." },
              { id: "team-item6", text: "البند السادس: الخطة محدثة ومعتمدة ويظهر تاريخ وجهة الاعتماد." },
              { id: "team-item7", text: "البند السابع: لدى الموظفين وعي ببرامج التعلم والتطوير الخاصة بهم والمحددة في الخطة." },
            ],
          },
          {
            id: "team2-i4",
            title: "المؤشر الرابع: تنفذ  المنظمة برامج التعلّم والتطوير  المخططة بما يضمن فرصاً متساوية لجميع العاملين والمتطوعين، وتحتفظ بمعلومات وسجلات مُحدّثة.",
            items: [
              { id: "team-item1", text: "البند الأول: تنفذ الجمعية برامج التعلّم والتطوير وفقًا للخطة المعتمدة لضمان تحقيق الأهداف." },
              { id: "team-item2", text: "البند الثاني: تُتاح فرص التعلم والتطوير لجميع الموظفين والمتطوعين دون تمييز." },
              { id: "team-item3", text: "البند الثالث: تُوفر الجمعية الموارد الكافية مثل المدربين ومواد تدريبية ووقت لتنفيذ البرامج بشكل فعال." },
              { id: "team-item4", text: "البند الرابع: توثق الجمعية تفاصيل برامج التعلم والتطوير بما في ذلك الأهداف والمشاركين والمخرجات." },
              { id: "team-item5", text: "البند الخامس: تحتفظ الجمعية بسجلات محدثة لكل موظف ومتطوع تشمل البرامج التي شارك فيها ونواتج التعلم." },
            ],
          },
          {
            id: "team2-i5",
            title: "المؤشر الخامس: تطبق المنظمة سياسات وإجراءات فعّالة لضمان سلامة الموظفين والمتطوعين أثناء العمل، ويتمتع الموظفون بالمعرفة والمهارات اللازمة للتعامل مع المخاطر المُتعلقة بالسلامة.",
            items: [
              { id: "team-item1", text: "البند الأول: تعتمد الجمعية سياسات مكتوبة وشاملة لضمان سلامة الموظفين والمتطوعين أثناء تنفيذ البرامج وتقديم الخدمات." },
              { id: "team-item2", text: "البند الثاني: ُوفر الجمعية تدريباً منتظماً للموظفين والمتطوعين حول التعامل مع المخاطر والإجراءات الوقائية." },
              { id: "team-item3", text: "البند الثالث: تُجري الجمعية تقييمًا دوريًا للمخاطر المحتملة أثناء تنفيذ البرامج وتقديم الخدمات." },
              { id: "team-item4", text: "البند الرابع: توفر الجمعية المعدات والأدوات الوقائية اللازمة لضمان سلامة العاملين والمتطوعين." },
              { id: "team-item5", text: "البند الخامس: تعتمد الجمعية آليات واضحة للإبلاغ عن الحوادث والتعامل معها بشكل فوري وفعّال." },
              { id: "team-item6", text: "البند السادس: تراجع الجمعية سياسات وإجراءات السلامة بشكل منتظم لضمان فعاليتها وملاءمتها للتغيرات." },
              { id: "team-item7", text: "البند السابع: تحتفظ الجمعية بسجلات محدثة حول التدريبات والحوادث والإجراءات المُتبعة لضمان الشفافية والتحسين المستمر." },
            ],
          },
          
        ],
      },
      {
        id: "team-c3",
        number: 1,
        name: "المعيار الثالث: إدارة الأداء",
        indicators: [
          {
            id: "team3-i1",
            title: "المؤشر الأول: تُحدد المنظمة مستويات الأداء والمهام المطلوبة من كل موظف ومتطوع، ويتمتع الجميع بفهم واضح لهذه المهام.",
            items: [
              { id: "team-item1", text: "البند الأول: تُحدد المنظمة مستويات الأداء والمهام المطلوبة من كل موظف ومتطوع." },
              { id: "team-item2", text: "البند الثاني: تحدد الجمعية مستويات الأداء المتوقعة لكل وظيفة أو دور." },
              { id: "team-item3", text: "البند الثالث: توثق الجمعية المهام والمستويات المطلوبة في توصيف وظيفي أو سجل واضح لكل موظف ومتطوع." },
              { id: "team-item4", text: "البند الرابع: توفر الجمعية تدريباً أو جلسات توجيهية لضمان فهم الجميع لمهامهم ومستويات الأداء المطلوبة." },
              { id: "team-item5", text: "البند الخامس: تحتفظ الجمعية بسجلات تثبت اطلاع الموظفين والمتطوعين على المهام والمسؤوليات الموكلة إليهم." },
            ],
          },
          {
            id: "team3-i2",
            title: "المؤشر الثاني: تُقيّم المنظمة أداء موظفيها ومتطوعيها بانتظام باستخدام منهجية مُحددة وملائمة، وتُناقش نتائج التقييم معهم.",
            items: [
              { id: "team-item1", text: "البند الأول: تُعتمد منهجية محددة وملائمة لتقييم أداء الموظفين والمتطوعين." },
              { id: "team-item2", text: "البند الثاني: تنفذ الجمعية تقييمات أداء منتظمة وفق جدول زمني واضح." },
              { id: "team-item3", text: "البند الثالث: تقارن الجمعية نتائج أداء الموظفين والمتطوعين بمعايير ومؤشرات محددة مسبقًا." },
              { id: "team-item4", text: "البند الرابع: تُناقش نتائج التقييم بشكل مباشر مع الموظفين والمتطوعين لتعزيز الفهم المتبادل." },
              { id: "team-item5", text: "البند الخامس: تُقدم للموظفين والمتطوعين ملاحظات بناءة تستهدف تحسين الأداء وتعزيز الكفاءات." },
              { id: "team-item6", text: "البند السادس: تحتفظ الجمعية بسجلات تقييم الأداء لكل موظف ومتطوع بشكل منتظم." },
              { id: "team-item7", text: "البند السابع: تحتفظ الجمعية بسجلات مناقشة نتائج التقييم مع كل موظف ومتطوع." },
              { id: "team-item8", text: "البند الثامن: تراجع الجمعية منهجية التقييم بانتظام لضمان ملاءمتها وتطويرها بما يتماشى مع احتياجات العمل." },
            ],
          },
          {
            id: "team3-i3",
            title: "المؤشر الثالث: تستخدم المنظمة نتائج تقييم الأداء لتقديم التوجيه والدعم اللازمين للموظفين والمتطوعين، وتوفير الموارد التي تُمكّنهم من إنجاز مهامهم وتحقيق النتائج المرجوة.",
            items: [
              { id: "team-item1", text: "البند الأول: تُحلل الجمعية نتائج تقييم الأداء لتحديد مجالات القوة والتطوير لكل موظف ومتطوع." },
              { id: "team-item2", text: "البند الثاني: تُوفر الجمعية توجيهًا شخصيًا بناءً على احتياجات كل موظف أو متطوع لتحسين أدائهم." },
              { id: "team-item3", text: "البند الثالث: تعد الجمعية خطط دعم واضحة تشمل التدريب والتوجيه أو الإرشاد لتحسين الأداء." },
              { id: "team-item4", text: "البند الرابع: تُوفر الجمعية الأدوات والموارد والتقنيات التي تساعد الموظفين والمتطوعين على إنجاز مهامهم بكفاءة." },
              { id: "team-item5", text: "البند الخامس: تُتابع الجمعية تنفيذ التوجيه والدعم لضمان تأثيرها الإيجابي على الأداء." },
              { id: "team-item6", text: "البند السادس: تُوثق الجمعية أنشطة الدعم والتوجيه لضمان الاستمرارية وتطوير الإجراءات بناءً على الاحتياجات المستقبلية." },
            ],
          },
          {
            id: "team3-i4",
            title: "المؤشر الرابع: تُعدّ المنظمة تقارير تحليلية عن أداء الموظفين والمتطوعين، وتُشاركها مع أصحاب المصلحة، وتستخدم الدروس المُستفادة لتحسين الأداء.",
            items: [
              { id: "team-item1", text: "البند الأول: ُعد الجمعية تقارير تحليلية شاملة عن أداء الموظفين والمتطوعين بناءً على تقييماتهم." },
              { id: "team-item2", text: "البند الثاني: تتضمن التقارير تحليلًا لنقاط القوة والضعف في أداء الموظفين والمتطوعين." },
              { id: "team-item3", text: "البند الثالث: تُظهر التقارير مدى ارتباط الأداء بتحقيق أهداف المنظمة." },
              { id: "team-item4", text: "البند الرابع: تُشارك المنظمة التقارير مع أصحاب المصلحة الرئيسيين لضمان الشفافية وتعزيز الثقة." },
              { id: "team-item5", text: "البند الخامس: تحدد الجمعية الدروس المستفادة من أداء الموظفين والمتطوعين لتحسين العمليات والإجراءات." },
              { id: "team-item6", text: "البند السادس: تُستخدم نتائج التحليل والدروس المستفادة لتطوير خطط لتحسين الأداء على المستوى الفردي والتنظيمي." },
              { id: "team-item7", text: "البند السابع: التقارير والدروس المستفادة موثقة بشكل منتظم و لأصحاب المصلحة الوصول إليها بسهوله ." },
            ],
          },
        ],
      },
    ],
  },
  {
    slug: "alsharakat",
    name: "الشراكات",
    criteria: [
      {
        id: "part-c1",
        number: 1,
        name: "المعيار الأول: تخطيط الشراكات",
        indicators: [
          {
            id: "part1-i1",
            title: "المؤشر الأول: تحدد المنظمة احتياجاتها من الشراكات الفنية التي تُعزز جودة خدماتها من خلال تحليل دوري لبرامجها وخدماتها.",
            items: [
              { id: "part-item1", text: "البند الأول: حددت الجمعية نوعية الشراكات الفنية اللازمة لتعزيز جودة الخدمات المقدمة." },
              { id: "part-item2", text: "البند الثاني: تحديد نوعية الشراكات الفنية كان استناداً إلى تحليل البرامج والخدمات ومتطلبات تنفيذها." },
              { id: "part-item3", text: "البند الثالث: لدى الجمعية وثيقة أو سجل تتضمن تحديد الشركاء المحتملين وهذا الوثيقة محدثة." },
              { id: "part-item4", text: "البند الرابع: يظهر في الوثيقة تاريخ آخر تحديث." },
            ],
          },
          {
            id: "part1-i2",
            title: "المؤشر الثاني: تجمع المنظمة معلومات عن الشركاء المُحتملين، وتُحلل مدى توافق توجهاتهم وقدراتهم مع أهداف برامجها وخدماتها.",
            items: [
              { id: "part-item1", text: "البند الأول: لدى الجمعية بيانات تفصيلية عن الشركاء المحتملين بما في ذلك خبراتهم وسجلهم في المجال." },
              { id: "part-item2", text: "البند الثاني: تُحلل الجمعية رؤية وأهداف الشركاء المحتملين للتأكد من توافقها مع رؤيتها وأهدافها." },
              { id: "part-item3", text: "البند الثالث: تُقيّم الجمعية الموارد والخبرات التي يمتلكها الشركاء المحتملون لدعم برامجها وخدماتها." },
              { id: "part-item4", text: "البند الرابع: تعتمد المنظمة معايير محددة وواضحة لتقييم مدى ملاءمة الشركاء المحتملين." },
              { id: "part-item5", text: "البند الخامس: تُوثق الجمعية نتائج تحليل الشركاء المحتملين لضمان الشفافية وسهولة الرجوع إليها." },
            ],
          },
          {
            id: "part1-i3",
            title: "المؤشر الثالث: تضع المنظمة خططاً واضحة للتواصل مع الشركاء المحتملين وتحدد الأهداف والوسائل ومتطلبات بناء شراكات فعالة.",
            items: [
              { id: "part-item1", text: "البند الأول: يوجد خطة مكتوبة ومفصلة للتواصل مع الشركاء المحتملين." },
              { id: "part-item2", text: "البند الثاني: تُحدد الأهداف المرجوة من بناء الشراكات بوضوح وربطها باحتياجات البرامج والخدمات." },
              { id: "part-item3", text: "البند الثالث: تحدد الجمعية الوسائل الأكثر فعالية للتواصل مثل الاجتماعات ورسائل البريد الإلكتروني والاتصال الهاتفي." },
              { id: "part-item4", text: "البند الرابع: تحدد الجمعية جدولًا زمنيًا لتطبيق خطة التواصل ومتابعة التنفيذ." },
              { id: "part-item5", text: "البند الخامس: تُقيم الجمعية فعالية وسائل وأهداف التواصل لضمان تحقيق نتائج إيجابية." },
              { id: "part-item6", text: "البند السادس: تُوثق الجمعية جميع خطوات التواصل ونتائجها لضمان الشفافية وتحسين الممارسات المستقبلية." },
            ],
          },
          {
            id: "part1-i4",
            title: "المؤشر الرابع: تعتمد المنظمة إطارًا واضحًا لإنهاء الشراكات، يشمل تحديد قواعد وآليات فك الارتباط منذ بداية الشراكة، وتنفذ هذا الإطار بما يضمن عملية إنهاء للشراكة تحافظ على العلاقات وتتيح فرصًا لإعادة التعاون مستقبلاً.",
            items: [
              { id: "part-item1", text: "البند الأول: تعتمد المنظمة إطارًا مكتوبًا وواضحًا يحدد قواعد وآليات الإنهاء منذ بداية الشراكة." },
              { id: "part-item2", text: "البند الثاني: تُحدد الجمعية معايير موضوعية لإنهاء الشراكة مثل انتهاء المشروع وعدم توافق الأهداف أو عدم الالتزام بالشروط." },
              { id: "part-item3", text: "البند الثالث: تُوضح الجمعية آليات إنهاء الشراكة مثل الإشعارات المسبقة والاجتماعات الختامية وتسليم الالتزامات." },
              { id: "part-item4", text: "البند الرابع: تُراجع الجمعية الإطار بعد كل عملية إنهاء شراكة لاستخلاص الدروس وتحسين الممارسات." },
              { id: "part-item5", text: "البند الخامس: تُتيح الجمعية في إطارها إمكانية إعادة التعاون مع الشركاء في المستقبل بناءً على التقييم المشترك." },
              { id: "part-item6", text: "البند السادس: يظهر في وثيقة الإطار تاريخ وجهة الاعتماد وتاريخ آخر تحديث." },
            ],
          },
        ],
      },
      {
        id: "part-c2",
        number: 2,
        name: "المعيار الثاني: إدارة الشراكات",
        indicators: [
          {
            id: "part2-i1",
            title: "المؤشر الأول: تتأكد المنظمة من استيفاء جميع المتطلبات النظامية، وذلك قبل توقيع أي اتفاقية شراكة، بما في ذلك مراجعة بنود الاتفاقية والتأكد من التزام الشركاء بالأنظمة والمعايير ذات الصلة.",
            items: [
              { id: "part-item1", text: "البند الأول: تُراجع الجمعية التزام الشركاء المحتملين بالأنظمة والمعايير." },
              { id: "part-item2", text: "البند الثاني: تُراجع الجمعية بنود الاتفاقية المقترحة لضمان توافقها مع المتطلبات النظامية." },
              { id: "part-item3", text: "البند الثالث: تُعرض الاتفاقيات على مستشار قانوني أو مختص للتأكد من توافقها مع الأنظمة ذات الصلة." },
              { id: "part-item4", text: "البند الرابع: تُوثق الجمعية جميع الخطوات والإجراءات التي تمت لمراجعة الاتفاقية والتأكد من الالتزام." },
            ],
          },
          {
            id: "part2-i2",
            title: "المؤشر الثاني: تتأكد المنظمة من تحديد اتفاقيات الشراكة لأدوار ومسؤوليات كل طرف بوضوح في دعم تنفيذ البرامج وتقديم الخدمات.",
            items: [
              { id: "part-item1", text: "البند الأول: تتأكد الجمعية أن الاتفاقية توضح بشكل مفصل أدوار ومسؤوليات كل طرف." },
              { id: "part-item2", text: "البند الثاني: تُراجع الأدوار والمسؤوليات مع جميع الأطراف المعنية لضمان التفاهم الكامل." },
              { id: "part-item3", text: "البند الثالث: تُكتب الأدوار والمسؤوليات بلغة واضحة وغير قابلة للتأويل لتجنب النزاعات." },
              { id: "part-item4", text: "البند الرابع: تُحدد الاتفاقية آليات متابعة أداء كل طرف في تنفيذ مسؤولياته." },
              { id: "part-item5", text: "البند الخامس: تُحدد اتفاقيات الشراكة إجراءات واضحة لتعديل الأدوار والمسؤوليات إذا لزم الأمر." },
              { id: "part-item6", text: "البند السادس: تُوثق الجمعية النسخة الموقعة من اتفاقيات الشراكة لضمان التزام جميع الأطراف." },
            ],
          },
          {
            id: "part2-i3",
            title: "المؤشر الثالث: تضع المنظمة إجراءات واضحة للتواصل مع الشركاء، وتتأكد من فهمهم لهذه الإجراءات، كما تجمع آراء الشركاء لمعالجة أي مشاكل أو قضايا قد تطرأ أثناء العمل.",
            items: [
              { id: "part-item1", text: "البند الأول: تُعد الجمعية إجراءات مكتوبة وواضحة للتواصل مع الشركاء تحدد القنوات والآليات." },
              { id: "part-item2", text: "البند الثاني: تُقدم المنظمة شرحًا وافياً لإجراءات التواصل لضمان فهم الشركاء لها." },
              { id: "part-item3", text: "البند الثالث: تُنشئ الجمعية آلية لجمع آراء الشركاء حول سير العمل والإجراءات المتبعة." },
              { id: "part-item4", text: "البند الرابع: تخصص الجمعية آلية واضحة لمعالجة المشاكل التي يثيرها الشركاء." },
              { id: "part-item5", text: "البند الخامس: تُقيم المنظمة بشكل دوري فعالية إجراءات التواصل ومدى رضا الشركاء عنها." },
              { id: "part-item6", text: "البند السادس: تُوثق المنظمة جميع عمليات التواصل وآراء الشركاء لضمان الشفافية والاستفادة المستقبلية." },
            ],
          },
          {
            id: "part2-i4",
            title: "المؤشر الرابع: ُحيل المنظمة المستفيدين إلى الشركاء الذين يُقدمون خدمات مُكملة من خلال إجراءات واضحة وموثقة، وتُوثّق هذه الإحالات بسجلات واضحة.",
            items: [
              { id: "part-item1", text: "البند الأول: تُحدد المنظمة الخدمات التي يُقدمها الشركاء وتُصنفها على أنها مكملة لخدماتها." },
              { id: "part-item2", text: "البند الثاني: يوجد لدى الجمعية إجراءات مكتوبة تُحدد كيفية إحالة المستفيدين إلى الشركاء." },
              { id: "part-item3", text: "البند الثالث: تُوثق الجمعية كل عملية إحالة بسجلات تحتوي على تفاصيل المستفيد والخدمة المقدمة." },
              { id: "part-item4", text: "البند الرابع: تُتابع الجمعية نتائج الإحالة مع الشريك لضمان تقديم الخدمة المطلوبة للمستفيد." },
              { id: "part-item5", text: "البند الخامس: تُراجع الجمعية إجراءات الإحالة بشكل دوري للتأكد من كفاءتها وملاءمتها." },
            ],
          },
        ],
      },
      {
        id: "part-c3",
        number: 3,
        name: "المعيار الثالث: تقييم الشراكات",
        indicators: [
          {
            id: "part3-i1",
            title: "المؤشر الأول: تقيّم المنظمة  الشراكات الفنية، وتحلل فوائدها  ومخاطرها، وتُقرر استمرارها أو إيقافها بناءً على نتائج التقييم والتحليل.",
            items: [
              { id: "part-item1", text: "البند الأول: لدى الجمعية منهجية واضحة وموثقة لتقييم الشراكات الفنية تشمل الفوائد والمخاطر. " },
              { id: "part-item2", text: "البند الثاني: تنفذ الجمعية تقييمًا دوريًا لكل شراكة فنية استنادًا إلى الأهداف المحددة مسبقًا. " },
              { id: "part-item3", text: "البند الثالث: تحلل الجمعية فوائد الشراكة بما في ذلك تأثيرها على جودة الخدمات وتحقيق الأهداف. " },
              { id: "part-item4", text: "البند الرابع: تُحدد الجمعية المخاطر المحتملة المتعلقة باستمرار الشراكة أو تنفيذها. " },
              { id: "part-item5", text: "البند الخامس: تُقرر الجمعية استمرار الشراكة أو إيقافها بناءً على نتائج التقييم والتحليل. " },
              { id: "part-item6", text: "البند السادس: تُوثق الجمعية نتائج التقييم والتحليل بشكل منظم وسهل الوصول. " },
              { id: "part-item7", text: "البند السابع: تُبلغ الجمعية الشركاء بقراراتها مع توضيح أسباب استمرار الشراكة أو إيقافها. " },
              { id: "part-item8", text: "البند الثامن: تُراجع الجمعية منهجية التقييم بشكل دوري بناءً على الدروس المستفادة. " },
            ],
          },
          {
            id: "part3-i2",
            title: "المؤشر الثاني: تُحافظ المنظمة على سجلات محدثة لبيانات الشركاء، بما في ذلك معلومات الاتصال والمشاريع المُنفذة ونتائج تقييم الشراكة.",
            items: [
              { id: "part-item1", text: "البند الأول: لدى الجمعية قاعدة بيانات تشمل جميع بيانات الشركاء. " },
              { id: "part-item2", text: "البند الثاني: تُحدث الجمعية بشكل دوري معلومات الاتصال بالشركاء مثل أرقام الهواتف والبريد الإلكتروني والعناوين. " },
              { id: "part-item3", text: "البند الثالث: تُسجل الجمعية تفاصيل المشاريع المُنفذة بالتعاون مع كل شريك. " },
              { id: "part-item4", text: "البند الرابع: تحتفظ الجمعية بنتائج تقييم الشراكات في السجلات المخصصة لكل شريك. " },
              { id: "part-item5", text: "البند الخامس: تُحدد الجمعية صلاحيات الوصول إلى قاعدة البيانات لضمان أمن المعلومات. " },
              { id: "part-item6", text: "البند السادس: تُراجع الجمعية السجلات بشكل دوري للتأكد من دقتها وتحديثها. " },
            ],
          },
        ],
      },
    ],
  },
  {
    slug: "altaathir",
    name: "التأثير",
    criteria: [
      {
        id: "impact-c1",
        number: 1,
        name: "المعيار الأول: تخطيط البرامج",
        indicators: [
          {
            id: "impact1-i1",
            title: "المؤشر الأول: تضع المنظمة سياسات موثقة ومحدثة تُحدد مبادئ وقواعد تقديم الخدمات للمستفيدين.",
            items: [
              { id: "impact-item1", text: "البند الأول: يوجد لدى الجمعية سياسات مكتوبة تُحدد مبادئ وقواعد تقديم الخدمات للمستفيدين. " },
              { id: "impact-item2", text: "البند الثاني: تتضمن السياسات مبادئ واضحة توجه تقديم الخدمات للمستفيدين مثل العدالة الشفافية والجودة. " },
              { id: "impact-item3", text: "البند الثالث: تُحدد السياسات القواعد المتعلقة بالإجراءات والمعايير والشروط لتقديم الخدمات. " },
              { id: "impact-item4", text: "البند الرابع: تُراجع السياسات وتُحدث بشكل دوري للتأكد من ملاءمتها للتغيرات والاحتياجات. " },
              { id: "impact-item5", text: "البند الخامس: وثيقة السياسات معتمدة ومحدثة ويظهر تاريخ الاعتماد وتاريخ آخر تحديث. " },
              { id: "impact-item6", text: "البند السادس: وثيقة السياسة متاحة وسهل الوصول لأصحاب العلاقة." },
              
            ],
          },
          {
            id: "impact1-i2",
            title: "المؤشر الثاني: تُحدد المنظمة بوضوح متطلبات ومعايير تقديم وإيقاف الخدمات،  بما يضمن وصول الفئات المستهدفة إليها بشكل عادل دون تمييز.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُحدد الجمعية متطلبات واضحة لتقديم الخدمات للفئات المستهدفة." },
              { id: "impact-item2", text: "البند الثاني: تُعرّف الجمعية معايير دقيقة تضمن جودة تقديم الخدمات ووصولها بشكل عادل." },
              { id: "impact-item3", text: "البند الثالث: تُحدد الجمعية آليات واضحة وإجراءات عادلة لإيقاف تقديم الخدمات عند الحاجة." },
              { id: "impact-item4", text: "البند الرابع: تُبلغ الجمعية المستفيدين بمتطلبات ومعايير تقديم وإيقاف الخدمات لضمان الشفافية." },
              { id: "impact-item5", text: "البند الخامس: تُراجع المنظمة المعايير بشكل دوري لتتوافق مع احتياجات الفئات المستهدفة والتغيرات في البيئة." },
            ],
          },
          {
            id: "impact1-i3",
            title: "المؤشر الثالث: توثق المنظمة إجراءات تقديم الخدمات وتجربة المستفيد وتطور أدلة إرشادية مفصّلة، توضح المراحل والخطوات وتحدد المسؤوليات والصلاحيات بوضوح.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُعد الجمعية وثائق شاملة تُحدد إجراءات تقديم الخدمات خطوة بخطوة." },
              { id: "impact-item2", text: "البند الثاني: تُطور الجمعية أدلة مفصلة توضح مراحل تقديم الخدمة والخطوات المطلوبة في كل مرحلة." },
              { id: "impact-item3", text: "البند الثالث: تُحدد الأدلة المسؤوليات والصلاحيات لكل مرحلة ولكل موظف أو فريق." },
              { id: "impact-item4", text: "البند الرابع: تُوثق الجمعية تجربة المستفيد وتدمجها في الأدلة لضمان تحسين الخدمات باستمرار." },
              { id: "impact-item5", text: "البند الخامس: تُراجع المنظمة الأدلة والإجراءات بانتظام لتتوافق مع احتياجات المستفيدين والتغيرات." },
              { id: "impact-item6", text: "البند السادس: الإجراءات والأدلة الإرشادية معتمدة ويظهر فيها تاريخ الاعتماد وتاريخ آخر تحديث." },

            ],
          },
          {
            id: "impact1-i4",
            title: "المؤشر الرابع: تضع المنظمة خطط عمل فعّالة تُحدد المهام والمسؤوليات والجداول الزمنية والموارد المطلوبة لتنفيذ البرامج وتقديم الخدمات.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُعد الجمعية خطط عمل واضحة ومفصلة لكل البرامج والخدمات." },
              { id: "impact-item2", text: "البند الثاني: تُحدد الجمعية المهام المطلوبة لكل برنامج أو خدمة والمسؤوليات الموكلة لكل فريق أو فرد." },
              { id: "impact-item3", text: "البند الثالث: تُحدد الجمعية مواعيد بدء وانتهاء كل مهمة وجداول زمنية واضحة لكل مرحلة." },
              { id: "impact-item4", text: "البند الرابع: تُوضح الجمعية الموارد البشرية والمالية والمادية اللازمة لتنفيذ الخطط." },
              { id: "impact-item5", text: "البند الخامس: تُراجع الجمعية الخطط للتحقق من واقعيتها وجدواها قبل التنفيذ." },
              { id: "impact-item6", text: "البند السادس: تُعدل الجمعية الخطط بناءً على التغيرات أو التحديات التي تظهر أثناء التنفيذ." },
            ],
          },
          {
            id: "impact1-i5",
            title: "المؤشر الخامس: تُطور المنظمة خطط مُتابعة تُحدد مواعيد إعداد التقارير، والبيانات المطلوبة، والجهات المسؤولة عن جمعها وتحليلها، وأصحاب المصلحة المعنيين بها.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُطور الجمعية خطط متابعة موثقة تحدد جميع الجوانب المرتبطة بمتابعة البرامج والخدمات." },
              { id: "impact-item2", text: "البند الثاني: تُحدد الجمعية مواعيد منتظمة لإعداد التقارير الدورية والمتخصصة." },
              { id: "impact-item3", text: "البند الثالث: تُوضح الجمعية نوعية البيانات اللازمة للمتابعة مثل  البيانات الكمية والنوعية." },
              { id: "impact-item4", text: "البند الرابع: تُعين الجمعية الفرق أو الأفراد المسؤولين عن جمع البيانات وتحليلها." },
              { id: "impact-item5", text: "البند الخامس: تُحدد الجمعية الجهات أو الأطراف التي ستُشارك التقارير معها." },
              { id: "impact-item6", text: "البند السادس: تُراجع الجمعية خطط المتابعة بشكل دوري لتتوافق مع التغيرات والاحتياجات الجديدة." },
            ],
          },
        ],
      },
      {
        id: "impact-c2",
        number: 2,
        name: "المعيار الثاني: تقديم الخدمات",
        indicators: [
          {
            id: "impact2-i1",
            title: "المؤشر الأول: توفر المنظمة  الموارد اللازمة لتنفيذ برامجها وخدماتها، بما في ذلك المرافق  والأجهزة والمعدات الضرورية.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُحدد الجمعية المرافق والأجهزة والمعدات الضرورية لتنفيذ البرامج والخدمات. " },
              { id: "impact-item2", text: "البند الثاني: تُؤمن الجمعية المرافق المناسبة من حيث الموقع والتجهيزات لضمان تنفيذ الأنشطة. " },
              { id: "impact-item3", text: "البند الثالث: تُوفر المنظمة الأجهزة والمعدات الضرورية بجودة وكفاءة تلبي احتياجات البرامج والخدمات. " },
              { id: "impact-item4", text: "البند الرابع: تنفذ الجمعية صيانة منتظمة للمرافق والمعدات لضمان استدامتها. " },
              { id: "impact-item5", text: "البند الخامس: تُراجع الجمعية توافر الموارد بشكل مستمر خلال تنفيذ البرامج والخدمات. " },
              { id: "impact-item6", text: "البند السادس: تُوثق الجمعية كل عمليات توفير الموارد وتخصيصها لضمان الشفافية والمساءلة. " },
            ],
          },
          {
            id: "impact2-i2",
            title: "المؤشر الثاني: تضمن المنظمة سهولة الوصول إلى أماكن تقديم البرامج والخدمات، مع توفير إرشادات واضحة للحركة داخلها.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُجري الجمعية تقييمًا دوريًا لمواقع تقديم البرامج والخدمات لضمان سهولة الوصول إليها. " },
              { id: "impact-item2", text: "البند الثاني: تُحدد الجمعية مواقع مناسبة من حيث القرب المرافق ووسائل النقل المتاحة. " },
              { id: "impact-item3", text: "البند الثالث: تُوفر الجمعية مداخل ومرافق ميسرة للأشخاص ذوي الاحتياجات الخاصة. " },
              { id: "impact-item4", text: "البند الرابع: تُطور الجمعية إرشادات واضحة ومحددة للحركة داخل المواقع. " },
              { id: "impact-item5", text: "البند الخامس: تُوفر الجمعية معلومات محدثة حول مواقع تقديم الخدمات وطرق الوصول إليها. " },
              { id: "impact-item6", text: "البند السادس: تُجمع آراء المستفيدين حول سهولة الوصول والتحرك داخل المواقع لتحسين الخدمات. " },
              { id: "impact-item7", text: "البند السابع: تُوثق الجمعية جميع التعديلات والتحسينات التي أُجريت على المرافق لتسهيل الوصول. " },
            ],
          },
          {
            id: "impact2-i3",
            title: "المؤشر الثالث: تزود المنظمة المستفيدين بمعلومات وافية عن خدماتها وكيفية الاستفادة منها، باستخدام وسائل تواصل متنوعة تناسب قدراتهم واحتياجاتهم.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُعد الجمعية قائمة شاملة بالخدمات التي تقدمها مع تفاصيل واضحة لكل خدمة." },
              { id: "impact-item2", text: "البند الثاني: تُعد الجمعية مواد توعوية تحتوي على معلومات عن كيفية الوصول إلى الخدمات والاستفادة منها. " },
              { id: "impact-item3", text: "البند الثالث: تستخدم الجمعية وسائل تواصل متنوعة مثل المواقع الإلكترونية ووسائل التواصل الاجتماعي والنشرات الورقية لتوصيل المعلومات. " },
              { id: "impact-item4", text: "البند الرابع: تُصمم المعلومات والمواد بما يناسب احتياجات المستفيدين بما في ذلك الأشخاص ذوي الإعاقة. " },
              { id: "impact-item5", text: "البند الخامس: تُوضح الجمعية للمستفيدين خطوات وإجراءات الاستفادة من الخدمات." },
              { id: "impact-item6", text: "البند السادس: تُجمع آراء المستفيدين حول وضوح المعلومات ومدى استفادتهم منها." },
              { id: "impact-item7", text: "البند السابع: تُحدث الجمعية المواد والمعلومات بشكل منتظم لضمان دقتها ومواكبتها للتغيرات." },
            ],
          },
          {
            id: "impact2-i4",
            title: "المؤشر الرابع: تُوفر المنظمة أدلة إرشادية لإدارة علاقتها مع المستفيدين أثناء وبعد تقديم الخدمات، وتضمن الإفصاح عن أي تضارب محتمل في المصالح.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُعد الجمعية أدلة مكتوبة توضح مبادئ وإجراءات إدارة العلاقة مع المستفيدين أثناء وبعد تقديم الخدمات. " },
              { id: "impact-item2", text: "البند الثاني: تتضمن الأدلة قواعد واضحة للتواصل والتعامل مع المستفيدين بما يعزز الثقة والاحترام المتبادل. " },
              { id: "impact-item3", text: "البند الثالث: تُحدد الجمعية الإجراءات الواجب اتباعها لضمان استمرارية العلاقة الإيجابية مع المستفيدين بعد تقديم الخدمة. " },
              { id: "impact-item4", text: "البند الرابع: تُحدد الجمعية آليات للإفصاح عن أي تضارب محتمل في المصالح أثناء تقديم الخدمات أو بعدها. " },
              { id: "impact-item5", text: "البند الخامس: تُوفر الجمعية تدريباً منتظماً للموظفين على استخدام الأدلة الإرشادية والالتزام بها. " },
              { id: "impact-item6", text: "البند السادس: تُراجع الأدلة الإرشادية بشكل دوري لضمان ملاءمتها وتحسينها بناءً على التغيرات أو الملاحظات." },
              { id: "impact-item7", text: "البند السابع: تُوثق الجمعية جميع التفاعلات مع المستفيدين والإجراءات المتخذة لإدارة العلاقة بفعالية." },
            ],
          },
          {
            id: "impact2-i5",
            title: "المؤشر الخامس: تطبق المنظمة إجراءات ومعايير فعّالة لضمان سلامة المستفيدين أثناء تقديم الخدمات، وتتأكد من وعي المستفيدين والعاملين بإجراءات وتعليمات السلامة.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُعد الجمعية إجراءات ومعايير مكتوبة لضمان سلامة المستفيدين أثناء تقديم الخدمات. " },
              { id: "impact-item2", text: "البند الثاني: تُوفر الجمعية تدريبًا منتظمًا للعاملين حول إجراءات وتعليمات السلامة. " },
              { id: "impact-item3", text: "البند الثالث: تُبلغ الجمعية المستفيدين بإجراءات السلامة والتعليمات الواجب اتباعها أثناء تلقي الخدمات. " },
              { id: "impact-item4", text: "البند الرابع: تُؤمن الجمعية الأدوات والمعدات الضرورية لضمان بيئة آمنة أثناء تقديم الخدمات. " },
              { id: "impact-item5", text: "البند الخامس: تُجري الجمعية تقييمًا منتظمًا للمخاطر المحتملة المتعلقة بسلامة المستفيدين. " },
              { id: "impact-item6", text: "البند السادس: تُعد الجمعية خطة طوارئ تتضمن آليات التعامل مع الحوادث والمواقف الطارئة. " },
              { id: "impact-item7", text: "البند السابع: تُوثق الجمعية جميع الحوادث والإجراءات المتخذة لضمان تحسين معايير السلامة بشكل مستمر. " },
            ],
          },
        ],
      },
      {
        id: "impact-c3",
        number: 3,
        name: "المعيار الثالث: جودة الخدمات",
        indicators: [
          {
            id: "impact3-i1",
            title: "المؤشر الأول: تحتفظ المنظمة بسجلات مُحدثة للمستفيدين والخدمات المُقدمة لهم، مع ضمان السرية والخصوصية وسهولة الوصول إلى هذه البيانات .",
            items: [
              { id: "impact-item1", text: "البند الأول: تُنشئ الجمعية نظامًا مخصصًا لتسجيل وحفظ بيانات المستفيدين والخدمات المقدمة لهم. " },
              { id: "impact-item2", text: "البند الثاني: تُحدث الجمعية سجلات المستفيدين والخدمات بشكل دوري لضمان دقتها. " },
              { id: "impact-item3", text: "البند الثالث: تعتمد الجمعية سياسات مكتوبة تضمن سرية وخصوصية بيانات المستفيدين. " },
              { id: "impact-item4", text: "البند الرابع: تُحدد الجمعية صلاحيات الوصول إلى بيانات المستفيدين لضمان استخدامها فقط من الأطراف المخولة. " },
              { id: "impact-item5", text: "البند الخامس: تُطبق الجمعية تقنيات وإجراءات لحماية السجلات من الوصول غير المصرح به أو التلاعب. " },
              { id: "impact-item6", text: "البند السادس: تُصمم الجمعية نظامًا يتيح الوصول السريع إلى بيانات المستفيدين عند الحاجة وبما لا يخل بالخصوصية. " },
              { id: "impact-item7", text: "البند السابع: تُراجع الجمعية نظام إدارة بيانات المستفيدين وسياساته لضمان استمرارية التوافق مع أفضل الممارسات. " },
            ],
          },
          {
            id: "impact3-i2",
            title: "المؤشر الثاني: تطبق المنظمة إجراءات فعّالة لمعالجة استفسارات واقتراحات وشكاوى المستفيدين، وتُعلمهم بهذه الإجراءات ومدة الاستجابة للتواصل معهم.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُحدد الجمعية آليات واضحة ومكتوبة لمعالجة استفسارات واقتراحات وشكاوى المستفيدين. " },
              { id: "impact-item2", text: "البند الثاني: تُوفر الجمعية قنوات تواصل متعددة تناسب جميع المستفيدين مثل الهاتف والبريد الإلكتروني ومنصات إلكترونية. " },
              { id: "impact-item3", text: "البند الثالث: تُحدد الجمعية مدة زمنية لمعالجة كل نوع من أنواع التواصل مثل استفسار واقتراح وشكوى. " },
              { id: "impact-item4", text: "البند الرابع: تُبلغ الجمعية المستفيدين بإجراءات معالجة استفساراتهم وشكاواهم من خلال مواد توعوية واضحة. " },
              { id: "impact-item5", text: "البند الخامس: تُدرب الجمعية موظفيها على التعامل مع استفسارات وشكاوى المستفيدين بكفاءة ومهنية. " },
              { id: "impact-item6", text: "البند السادس: تُسجل الجمعية جميع الاستفسارات والاقتراحات والشكاوى مع تفاصيل المعالجة والإجراءات المتخذة. " },
              { id: "impact-item7", text: "البند السابع: تُراجع الجمعية بيانات الشكاوى والاستفسارات بانتظام لتحليل الأنماط وتحسين العمليات. " },
              { id: "impact-item8", text: "البند الثامن: تجمع الجمعية آراء المستفيدين حول فعالية الإجراءات ومدى رضاهم عن الاستجابة. " },
            ],
          },
          {
            id: "impact3-i3",
            title: "المؤشر الثالث: تُطبق المنظمة نظاماً لتحديد وحماية وتأمين وثائق وممتلكات المستفيدين، ولديها إجراءات للتعامل مع حالات فقدانها أو تلفها.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُطور الجمعية سياسة مكتوبة مخصصة لتحديد وحماية وتأمين وثائق وممتلكات المستفيدين. " },
              { id: "impact-item2", text: "البند الثاني: تُحدد الجمعية إجراءات وقائية لتجنب فقدان أو تلف الوثائق والممتلكات. " },
              { id: "impact-item3", text: "البند الثالث: تُوفر الجمعية وسائل مادية وتقنية لحماية ممتلكات المستفيدين مثل الخزائن أو التشفير الإلكتروني. " },
              { id: "impact-item4", text: "البند الرابع: تُنشئ الجمعية سجلات دقيقة تحتوي على بيانات كاملة عن الوثائق والممتلكات المحفوظة. " },
              { id: "impact-item5", text: "البند الخامس: تُوثق الجمعية آليات واضحة للتعامل مع حالات فقدان أو تلف الوثائق والممتلكات. " },
              { id: "impact-item6", text: "البند السادس: تُعلم الجمعية المستفيدين بحقوقهم وإجراءات التعامل مع ممتلكاتهم وتوثيقها. " },
              { id: "impact-item7", text: "البند السابع: تُراجع الجمعية نظام الحماية والإجراءات بشكل منتظم للتأكد من فاعليته وتحسينه عند الحاجة. " },
              { id: "impact-item8", text: "البند الثامن: تُدرب الجمعية العاملين على اتباع النظام والإجراءات المتعلقة بحماية الممتلكات. " },
            ],
          },
          {
            id: "impact3-i4",
            title: "المؤشر الرابع: تُطور المنظمة خطة فعّالة للتعامل مع حالات عدم المطابقة في المنتجات والخدمات، وتُحدد إجراءات لمنع تكرارها، وتُتابع فعالية هذه الإجراءات.",
            items: [
              { id: "impact-item1", text: "البند الأول: تُطور الجمعية خطة مكتوبة تحدد خطوات واضحة لإدارة حالات عدم المطابقة ومعالجتها. " },
              { id: "impact-item2", text: "البند الثاني: تُعرف الجمعية بشكل دقيق حالات عدم المطابقة والمعايير التي تُستخدم لتحديدها. " },
              { id: "impact-item3", text: "البند الثالث: تُجري الجمعية تحليلاً شاملاً لتحديد الأسباب الجذرية لحالات عدم المطابقة باستخدام أدوات تحليلية فعّالة. " },
              { id: "impact-item4", text: "البند الرابع: تُحدد الجمعية الإجراءات اللازمة لتصحيح حالات عدم المطابقة الحالية ومنع تكرارها مستقبلاً. " },
              { id: "impact-item5", text: "البند الخامس: تُوضح الجمعية المسؤوليات والصلاحيات للجهة المسؤولة عن تنفيذ الإجراءات التصحيحية والوقائية. " },
              { id: "impact-item6", text: "البند السادس: تُتابع الجمعية تنفيذ الإجراءات بشكل دوري لضمان تطبيقها بشكل صحيح وفعّال. " },
              { id: "impact-item7", text: "البند السابع: تُقيم الجمعية مدى فعالية الإجراءات التصحيحية والوقائية في معالجة حالات عدم المطابقة. " },
              { id: "impact-item8", text: "البند الثامن: تُوثق الجمعية جميع حالات عدم المطابقة والإجراءات المتخذة لمعالجتها وتُحدث خطتها بناءً على الدروس المستفادة. " },
            ],
          },
        ],
      },
    ],
  },

  {
    slug: "albaramij",
    name: "البرامج",
    criteria: [
      {
        id: "prog-c1",
        number: 1,
        name: "المعيار الأول: نتائج الفريق",
        indicators: [
          {
            id: "prog1-i1",
            title: "المؤشر الأول: تراقب المنظمة معدلات الأخطاء أو الشكاوى المرتبطة بأداء العاملين والمتطوعين، وتحلل المعلومات وتحدد المجالات التي تحتاج إلى تحسينات لضمان جودة الخدمة المقدمة.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُطور الجمعية نظامًا لتسجيل الأخطاء والشكاوى المتعلقة بأداء العاملين والمتطوعين. " },
              { id: "prog-item2", text: "البند الثاني: تُحدد الجمعية معايير واضحة لتصنيف الأخطاء والشكاوى وتوثيقها. " },
              { id: "prog-item3", text: "البند الثالث: تُجمع الجمعية البيانات المتعلقة بالأخطاء والشكاوى من مصادر متعددة بشكل منتظم. " },
              { id: "prog-item4", text: "البند الرابع: تُجري الجمعية تحليلًا شاملًا للبيانات لتحديد أنماط الأخطاء ومسببات الشكاوى. " },
              { id: "prog-item5", text: "البند الخامس: تُطور الجمعية خطة لتحسين أداء العاملين والمتطوعين تتضمن إجراءات تصحيحية لمنع التكرار. " },
              { id: "prog-item6", text: "البند السادس: تُتابع الجمعية تنفيذ إجراءات التحسين وتقيم فعاليتها في تقليل الأخطاء والشكاوى. " },
              { id: "prog-item7", text: "البند السابع: تُوثق الجمعية جميع البيانات والإجراءات والتحسينات لضمان استدامة الجودة وتحقيق الشفافية. " },
            ],
          },
          {
            id: "prog1-i2",
            title: "المؤشر الثاني: تجري المنظمة تقييماً لكفاءة أداء العاملين والمتطوعين من منظور المستفيدين، وتقيس مستوى ثقة المستفيدين ورضاهم عن الأداء.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُحدد الجمعية معايير واضحة لتقييم كفاءة العاملين والمتطوعين بناءً على دورهم في تقديم الخدمات. " },
              { id: "prog-item2", text: "البند الثاني: تُعد الجمعية استبيانات أو أدوات مخصصة لقياس رضا المستفيدين عن الأداء. " },
              { id: "prog-item3", text: "البند الثالث: تُجمع الجمعية آراء المستفيدين بشكل منتظم عبر استبيانات مقابلات أو جلسات نقاش. " },
              { id: "prog-item4", text: "البند الرابع: تُقيس الجمعية مستوى ثقة المستفيدين ورضاهم عن أداء العاملين والمتطوعين باستخدام مؤشرات محددة. " },
              { id: "prog-item5", text: "البند الخامس: تُحلل الجمعية البيانات المستخلصة من آراء المستفيدين لتحديد نقاط القوة وفرص التحسين في الأداء. " },
              { id: "prog-item6", text: "البند السادس: تُشارك الجمعية نتائج التقييم مع العاملين والمتطوعين لتعزيز الشفافية وتحفيز التحسين. " },
              { id: "prog-item7", text: "البند السابع: تُوثق الجمعية عمليات التقييم ونتائجها لضمان الاستمرارية والتحسين المستمر. " },
            ],
          },
          {
            id: "prog1-i3",
            title: "المؤشر الثالث: توثق المنظمة الدروس المستفادة من تقييم نتائج الفريق وتحللها وتوظفها في تحسين أداء العاملين وكفاءة العمليات وجودة الخدمات.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُجمع الجمعية بيانات شاملة عن أداء العاملين وكفاءة العمليات وجودة الخدمات من خلال التقييمات الدورية. " },
              { id: "prog-item2", text: "البند الثاني: تُحلل الجمعية البيانات لتحديد الدروس المستفادة من نقاط القوة والضعف في أداء الفريق والعمليات. " },
              { id: "prog-item3", text: "البند الثالث: تُعد الجمعية سجلات توثيقية تحتوي على الدروس المستفادة بالتفصيل وأسبابها وتأثيرها. " },
              { id: "prog-item4", text: "البند الرابع: تُشارك الجمعية الدروس المستفادة مع العاملين لتحفيز تحسين الأداء وتعزيز الشفافية. " },
              { id: "prog-item5", text: "البند الخامس: تُصمم الجمعية خططًا لتحسين أداء العاملين بناءً على الدروس المستفادة. " },
              { id: "prog-item6", text: "البند السادس: تُتابع الجمعية تطبيق الدروس المستفادة وتقيم أثرها على الأداء العام وجودة العمليات. " },
              { id: "prog-item7", text: "البند السابع: تُوثق الجمعية الدروس الجديدة بشكل مستمر لضمان تحقيق التحسين المستدام. " },
            ],
          },
        ],
      },
      {
        id: "prog-c2",
        number: 2,
        name: "المعيار الثاني: نتائج العمليات",
        indicators: [
          {
            id: "prog2-i1",
            title: "المؤشر الأول: تُحدد المنظمة مؤشرات أداء رئيسية لقياس أداء عملياتها، وتضع خططاً واضحة لقياسها، وتضمن وعي العاملين والمتطوعين بأهداف القياس وكيفية جمع البيانات.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُحدد الجمعية مؤشرات أداء واضحة ومرتبطة بأهداف العمليات والخدمات. " },
              { id: "prog-item2", text: "البند الثاني: تُعد الجمعية خططاً مكتوبة تتضمن آليات جمع البيانات وتحليلها لقياس مؤشرات الأداء. " },
              { id: "prog-item3", text: "البند الثالث: تُحدد الجمعية مصادر موثوقة لجمع البيانات المتعلقة بمؤشرات الأداء مثل التقارير أو الاستبيانات. " },
              { id: "prog-item4", text: "البند الرابع: تُحدد الجمعية فترات زمنية منتظمة لقياس المؤشرات وتحليلها مثل شهريًا أو ربع سنويًا. " },
              { id: "prog-item5", text: "البند الخامس: تُبلغ الجمعية العاملين والمتطوعين بأهداف القياس وأهمية دورهم في جمع البيانات. " },
              { id: "prog-item6", text: "البند السادس: تُوفر الجمعية تدريباً للعاملين والمتطوعين حول آليات جمع البيانات وضمان دقتها. " },
              { id: "prog-item7", text: "البند السابع: تُراجع الجمعية مؤشرات الأداء وخطط القياس بشكل دوري للتأكد من مواءمتها مع الأهداف الحالية. " },
            ],
          },
          {
            id: "prog2-i2",
            title: "المؤشر الثاني: تجمع المنظمة بيانات أداء العمليات، وتُحللها، وتتخذ الإجراءات التصحيحية اللازمة عند وجود أي انحراف عن الأهداف.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُحلل الجمعية البيانات لتحديد مدى تحقيق الأهداف وكشف أي انحرافات في الأداء. " },
              { id: "prog-item2", text: "البند الثاني: تُعد الجمعية تقارير تحليلية دورية تلخص نتائج تحليل البيانات والانحرافات المكتشفة. " },
              { id: "prog-item3", text: "البند الثالث: تُحدد الجمعية خططًا وإجراءات لمعالجة الانحرافات المكتشفة وضمان العودة إلى المسار الصحيح. " },
              { id: "prog-item4", text: "البند الرابع: تُحدد الجمعية المسؤوليات والجدول الزمني لتنفيذ الإجراءات التصحيحية. " },
              { id: "prog-item5", text: "البند الخامس: تُتابع الجمعية تطبيق الإجراءات التصحيحية بانتظام لضمان تحقيق النتائج المرجوة. " },
              { id: "prog-item6", text: "البند السادس: تُقيم الجمعية أثر الإجراءات التصحيحية على الأداء وتوثق الدروس المستفادة لتحسين العمليات المستقبلية. " },
              { id: "prog-item7", text: "البند السابع: تُوثق الجمعية جميع البيانات والتحليلات والإجراءات التصحيحية المتخذة لضمان الشفافية والتحسين المستمر. " },
              { id: "prog-item8", text: "البند الثامن: تُعد الجمعية تقارير دورية مفصلة تلخص أداء العمليات وتوضح الإنجازات والتحديات. " },
            ],
          },
          {
            id: "prog2-i3",
            title: "المؤشر الثالث: تُعد المنظمة تقارير دورية عن أداء عملياتها وتُشاركها مع أصحاب المصلحة، وتُستخدم هذه التقارير لمقارنة الأداء بين الفترات المختلفة وتراقب اتجاهات التحسن في الأداء.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُحلل التقارير أداء العمليات وتُقارن النتائج بين الفترات الزمنية المختلفة لتحديد التغيرات والاتجاهات. " },
              { id: "prog-item2", text: "البند الثاني: تُحدد المنظمة الاتجاهات الإيجابية أو السلبية في الأداء بناءً على البيانات المُجمعة وتحليلها. " },
              { id: "prog-item3", text: "البند الثالث: تُشارك الجمعية التقارير الدورية مع أصحاب المصلحة الداخليين والخارجيين لتعزيز الشفافية وبناء الثقة. " },
              { id: "prog-item4", text: "البند الرابع: تُوثق الجمعية جميع التقارير الدورية وتعليقات أصحاب المصلحة لضمان المتابعة وتحسين العمليات. " },
              { id: "prog-item5", text: "البند الخامس: تُراجع الجمعية منهجية إعداد التقارير بشكل دوري لتحسين دقتها وفائدتها. " },
              { id: "prog-item6", text: "البند السادس: تُحدد الجمعية مؤشرات واضحة وقابلة للقياس لقياس مخرجات البرامج والخدمات. " },
            ],
          },
        ],
      },
      {
        id: "prog-c3",
        number: 3,
        name: "المعيار الثالث: نتائج المستفيدين",
        indicators: [
          {
            id: "prog3-i1",
            title: "المؤشر الأول: تُحدد المنظمة مؤشرات للمخرجات والنتائج المتعلقة بالمستفيدين، وتضع خطة تقييم واضحة تُحدد فيها المسؤوليات والصلاحيات ودورية جمع البيانات.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُحدد الجمعية مؤشرات نتائج واضحة لقياس تأثير البرامج والخدمات على حياة المستفيدين. " },
              { id: "prog-item2", text: "البند الثاني: تُطور الجمعية خطة تقييم تُحدد فيها آليات قياس المؤشرات والبيانات المطلوبة. " },
              { id: "prog-item3", text: "البند الثالث: تُوضح الجمعية في خطة التقييم الأدوار والمسؤوليات لكل فريق أو فرد معني بجمع وتحليل البيانات. " },
              { id: "prog-item4", text: "البند الرابع: تُحدد الجمعية دورية منتظمة لجمع البيانات وتحليلها مثل أسبوعياً وشهريًا وربعياً. " },
              { id: "prog-item5", text: "البند الخامس: تُختار الجمعية أدوات مناسبة لجمع البيانات مثل استبيانات أو مقابلات أو تقارير. " },
              { id: "prog-item6", text: "البند السادس: تُحدد الجمعية النتائج المرجوة من برامجها وخدماتها وتأثيرها على المستفيدين بوضوح. " },
            ],
          },
          {
            id: "prog3-i2",
            title: "المؤشر الثاني: العاملون والمتطوعون على دراية بنتائج البرامج والخدمات التي تسعى المنظمة لتحقيقها على المستفيدين، وكيفية جمع البيانات وتحليلها.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُعد الجمعية مواد توعوية تتضمن شرحًا لأهداف البرامج ونتائجها المرجوة على المستفيدين. " },
              { id: "prog-item2", text: "البند الثاني: تُنظم الجمعية جلسات تعريفية للعاملين والمتطوعين لشرح الأهداف والنتائج المتوقعة. " },
              { id: "prog-item3", text: "البند الثالث: تُوضح الجمعية للعاملين والمتطوعين أهمية جمع البيانات ودورها في قياس النجاح وتحسين الأداء. " },
              { id: "prog-item4", text: "البند الرابع: تُوفر الجمعية تدريبًا عمليًا على آليات جمع البيانات بما يتوافق مع مؤشرات الأداء المحددة. " },
              { id: "prog-item5", text: "البند الخامس: تُقدم الجمعية إرشادات حول كيفية تحليل البيانات لفهم تأثير البرامج على المستفيدين. " },
              { id: "prog-item6", text: "البند السادس: تُوثق الجمعية جميع جلسات التوعية والتدريب والتقارير لضمان استمرارية التحسين. " },
              { id: "prog-item7", text: "البند السابع: أنشأت الجمعية آلية لتوثيق الإخفاقات التي واجهتها وقصص النجاح التي تحققت أثناء تنفيذ البرامج وتقديم الخدمات. " },
            ],
          },
          {
            id: "prog3-i3",
            title: "المؤشر الثالث: تجمع المنظمة بيانات المخرجات والنتائج، وتوثق الإخفاقات وقصص النجاح، وتُعدّ تقارير عن النتائج وتُشاركها مع أصحاب المصلحة.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُعد الجمعية تقارير مفصلة تتضمن المخرجات والنتائج إلى جانب الإخفاقات والدروس المستفادة وقصص النجاح. " },
              { id: "prog-item2", text: "البند الثاني: تُشارك الجمعية تقارير النتائج بشكل دوري مع أصحاب المصلحة لتعزيز الشفافية وبناء الثقة. " },
              { id: "prog-item3", text: "البند الثالث: لدى الجمعية آلية لجمع ملاحظات أصحاب المصلحة حول التقارير المقدمة لتحسين جودة التقارير والعمليات. " },
              { id: "prog-item4", text: "البند الرابع: تُوثق الجمعية جميع البيانات المجمعة والتحليلات والتقارير لضمان حفظها واستخدامها في المستقبل. " },
              { id: "prog-item5", text: "البند الخامس: تُستخلص الجمعية الدروس المستفادة من النجاحات والإخفاقات في تنفيذ البرامج والخدمات. " },
            ],
          },
          {
            id: "prog3-i4",
            title: "المؤشر الرابع: توثق المنظمة الدروس المستفادة من تحليل النتائج وتستخدمها في تطوير وتحسين البرامج والخدمات.",
            items: [
              { id: "prog-item1", text: "البند الأول: تُعد الجمعية سجلات منظمة تحتوي على الدروس المستفادة من تحليل النتائج. " },
              { id: "prog-item2", text: "البند الثاني: تُشارك الجمعية الدروس المستفادة مع الفرق العاملة لتعزيز الفهم المشترك والتحسين الجماعي. " },
              { id: "prog-item3", text: "البند الثالث: تُستخدم النتائج المُوثقة من الإخفاقات والنجاحات لتطوير البرامج وتحسين الأداء المستقبلي. " },
              { id: "prog-item4", text: "البند الرابع: تُحدث الجمعية الإجراءات التشغيلية بناءً على الدروس المستفادة لضمان تجنب التحديات السابقة. " },
              { id: "prog-item5", text: "البند الخامس: تُتابع الجمعية تنفيذ التحسينات الناتجة عن الدروس المستفادة وتقيم أثرها على جودة البرامج والخدمات. " },
              { id: "prog-item6", text: "البند السادس: تُوثق الجمعية جميع الإجراءات التي تمت بناءً على الدروس المستفادة لضمان استدامة التحسين. " },
            ],
          },
        ],
      },
    ],
  },
];

// Result calculation helper
type ResultType = "pending" | "needs_minor" | "needs_major" | "complete" | "incomplete";

const getResultLabel = (result: ResultType): string => {
  switch (result) {
    case "needs_minor":
      return "بحاجة إلى تحسين بسيط";
    case "needs_major":
      return "بحاجة إلى تحسين كبير";
    case "complete":
      return "مكتمل";
    case "incomplete":
      return "غير مكتمل";
    default:
      return "—";
  }
};

const getResultColor = (result: ResultType): string => {
  switch (result) {
    case "needs_minor":
      return "#22c55e";
    case "needs_major":
      return "#f5961e";
    case "complete":
      return "#148287";
    case "incomplete":
      return "#9ca3af";
    default:
      return "#9ca3af";
  }
};

const TechnicalEvaluationIndicators = () => {
  const { courseSlug } = useParams<{ courseSlug: string }>();
  const { toast } = useToast();
  
  // Find the current course
  const currentCourse = coursesData.find((c) => c.slug === courseSlug) || coursesData[0];
  
  // State for checkboxes: { [itemId]: boolean }
  const [checkedItems, setCheckedItems] = useState<Record<string, boolean>>({});
  
  // State for uploaded files: { [itemId]: File | null }
  const [uploadedFiles, setUploadedFiles] = useState<Record<string, File | null>>({});
  
  // State for indicator results: { [indicatorId]: ResultType }
  const [indicatorResults, setIndicatorResults] = useState<Record<string, ResultType>>({});
  
  // State for active button per indicator: { [indicatorId]: "plan" | "evidence" | "notes" | null }
  const [activeButtons, setActiveButtons] = useState<Record<string, "plan" | "evidence" | "notes" | null>>({});
  
  // Evidence records state with localStorage persistence
  const [evidenceRecords, setEvidenceRecords] = useState<EvidenceRecord[]>(() => {
    const saved = localStorage.getItem(`evidence-${courseSlug}`);
    return saved ? JSON.parse(saved) : [];
  });

  // Improvement tasks state with localStorage persistence
  const [improvementTasks, setImprovementTasks] = useState<ImprovementTask[]>(() => {
    const saved = localStorage.getItem(`improvement-tasks-${courseSlug}`);
    return saved ? JSON.parse(saved) : [];
  });

  // Team members state with localStorage persistence
  const [teamMembers, setTeamMembers] = useState<string[]>(() => {
    const saved = localStorage.getItem(`team-members-${courseSlug}`);
    return saved ? JSON.parse(saved) : [];
  });

  // Notes state with localStorage persistence
  const [notes, setNotes] = useState<NoteRecord[]>(() => {
    const saved = localStorage.getItem(`notes-${courseSlug}`);
    return saved ? JSON.parse(saved) : [];
  });

  // Note input state per indicator
  const [noteInputs, setNoteInputs] = useState<Record<string, string>>({});

  // Modal states
  const [isAddTaskModalOpen, setIsAddTaskModalOpen] = useState(false);
  const [isEditTaskModalOpen, setIsEditTaskModalOpen] = useState(false);
  const [activeIndicatorForTask, setActiveIndicatorForTask] = useState<string | null>(null);
  const [editingTask, setEditingTask] = useState<ImprovementTask | null>(null);
  const [newTaskText, setNewTaskText] = useState("");
  const [newTaskAssignee, setNewTaskAssignee] = useState("");
  const [newMemberName, setNewMemberName] = useState("");

  // Persist evidence to localStorage
  useEffect(() => {
    localStorage.setItem(`evidence-${courseSlug}`, JSON.stringify(evidenceRecords));
  }, [evidenceRecords, courseSlug]);

  // Persist improvement tasks to localStorage
  useEffect(() => {
    localStorage.setItem(`improvement-tasks-${courseSlug}`, JSON.stringify(improvementTasks));
  }, [improvementTasks, courseSlug]);

  // Persist team members to localStorage
  useEffect(() => {
    localStorage.setItem(`team-members-${courseSlug}`, JSON.stringify(teamMembers));
  }, [teamMembers, courseSlug]);

  // Persist notes to localStorage
  useEffect(() => {
    localStorage.setItem(`notes-${courseSlug}`, JSON.stringify(notes));
  }, [notes, courseSlug]);
  
  // File input refs
  const fileInputRefs = useRef<Record<string, HTMLInputElement | null>>({});
  
  // General evidence upload ref
  const generalEvidenceInputRef = useRef<Record<string, HTMLInputElement | null>>({});

  // Helper to get item label from item index
  const getItemLabel = (index: number): string => {
    const labels = ["الأول", "الثاني", "الثالث", "الرابع", "الخامس", "السادس", "السابع", "الثامن", "التاسع", "العاشر"];
    return `البند ${labels[index] || (index + 1)}`;
  };

  // Helper to format date as DD-MM
  const formatDate = (): string => {
    const now = new Date();
    const day = String(now.getDate()).padStart(2, "0");
    const month = String(now.getMonth() + 1).padStart(2, "0");
    return `${day}-${month}`;
  };

  // Check if item has evidence
  const hasEvidence = (itemId: string): boolean => {
    return evidenceRecords.some((e) => e.itemId === itemId && !e.hidden);
  };

  // Get evidence count for an indicator
  const getEvidenceCount = (indicatorId: string): number => {
    return evidenceRecords.filter((e) => e.indicatorId === indicatorId && !e.hidden).length;
  };
  
  const handleButtonClick = (indicatorId: string, button: "plan" | "evidence" | "notes") => {
    setActiveButtons((prev) => ({
      ...prev,
      [indicatorId]: prev[indicatorId] === button ? null : button,
    }));
  };

  const handleCheckChange = (itemId: string, checked: boolean) => {
    setCheckedItems((prev) => ({ ...prev, [itemId]: checked }));
  };

  const handleUploadClick = (itemId: string) => {
    fileInputRefs.current[itemId]?.click();
  };

  const handleFileChange = (itemId: string, indicatorId: string, itemIndex: number, event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (!file) return;
    
    setUploadedFiles((prev) => ({ ...prev, [itemId]: file }));
    
    // Create evidence record
    const newEvidence: EvidenceRecord = {
      id: `${itemId}-${Date.now()}`,
      indicatorId,
      itemId,
      itemLabel: getItemLabel(itemIndex),
      fileName: file.name,
      uploadedAt: formatDate(),
      status: "غير معتمد",
      hidden: false,
    };
    
    setEvidenceRecords((prev) => [...prev, newEvidence]);
  };

  const handleGeneralEvidenceUpload = (indicatorId: string, event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (!file) return;
    
    const newEvidence: EvidenceRecord = {
      id: `general-${indicatorId}-${Date.now()}`,
      indicatorId,
      itemId: `general-${indicatorId}`,
      itemLabel: "بند غير محدد",
      fileName: file.name,
      uploadedAt: formatDate(),
      status: "غير معتمد",
      hidden: false,
    };
    
    setEvidenceRecords((prev) => [...prev, newEvidence]);
  };

  const toggleEvidenceVisibility = (evidenceId: string) => {
    setEvidenceRecords((prev) =>
      prev.map((e) => (e.id === evidenceId ? { ...e, hidden: !e.hidden } : e))
    );
  };

  const deleteEvidence = (evidenceId: string) => {
    setEvidenceRecords((prev) => prev.filter((e) => e.id !== evidenceId));
  };

  const calculateIndicatorResult = (indicator: Indicator) => {
    const checkedCount = indicator.items.filter((item) => checkedItems[item.id]).length;
    const totalItems = indicator.items.length;
    const percentage = totalItems > 0 ? (checkedCount / totalItems) * 100 : 0;

    let result: ResultType;
    if (percentage === 0) {
      result = "incomplete";
    } else if (percentage < 50) {
      result = "needs_major";
    } else if (percentage < 100) {
      result = "needs_minor";
    } else {
      result = "complete";
    }

    setIndicatorResults((prev) => ({ ...prev, [indicator.id]: result }));

    // Regenerate auto tasks based on result
    regenerateAutoTasks(indicator.id, result, indicator.items.filter((item) => !checkedItems[item.id]));
  };

  // Generate/regenerate auto tasks for an indicator
  const regenerateAutoTasks = (indicatorId: string, result: ResultType, uncheckedItems: VerificationItem[]) => {
    // Remove existing auto tasks for this indicator
    setImprovementTasks((prev) => {
      const filtered = prev.filter((t) => !(t.indicatorId === indicatorId && t.isAuto));
      
      // If result is "complete", no auto tasks needed
      if (result === "complete") {
        return filtered;
      }

      // Generate auto tasks for unchecked items (max 2)
      const autoTasks: ImprovementTask[] = uncheckedItems.slice(0, 2).map((item, index) => ({
        id: `auto-${indicatorId}-${item.id}-${Date.now()}-${index}`,
        indicatorId,
        type: "آلي",
        taskText: `يتطلب استكمال: ${item.text.substring(0, 80)}...`,
        date: formatDate(),
        assignee: "",
        status: "تحت التنفيذ",
        isAuto: true,
      }));

      return [...filtered, ...autoTasks];
    });
  };

  // Get improvement tasks count for an indicator
  const getImprovementTasksCount = (indicatorId: string): number => {
    return improvementTasks.filter((t) => t.indicatorId === indicatorId).length;
  };

  // Get notes count for an indicator
  const getNotesCount = (indicatorId: string): number => {
    return notes.filter((n) => n.indicatorId === indicatorId).length;
  };

  // Handle saving a note
  const handleSaveNote = (indicatorId: string) => {
    const noteText = noteInputs[indicatorId]?.trim();
    
    if (!noteText) {
      toast({
        title: "تنبيه",
        description: "اكتب ملاحظة قبل الحفظ",
        variant: "destructive",
      });
      return;
    }

    const newNote: NoteRecord = {
      id: `note-${indicatorId}-${Date.now()}`,
      indicatorId,
      text: noteText,
      date: formatDate(),
      source: "المنظمة",
    };

    setNotes((prev) => [...prev, newNote]);
    setNoteInputs((prev) => ({ ...prev, [indicatorId]: "" }));
    
    toast({
      title: "تم",
      description: "تم حفظ الملاحظة",
    });
  };

  // Open add task modal
  const openAddTaskModal = (indicatorId: string) => {
    setActiveIndicatorForTask(indicatorId);
    setNewTaskText("");
    setNewTaskAssignee("");
    setIsAddTaskModalOpen(true);
  };

  // Add new manual task
  const handleAddTask = () => {
    if (!newTaskText.trim() || !activeIndicatorForTask) return;

    const newTask: ImprovementTask = {
      id: `manual-${activeIndicatorForTask}-${Date.now()}`,
      indicatorId: activeIndicatorForTask,
      type: "يدوي",
      taskText: newTaskText.trim(),
      date: formatDate(),
      assignee: newTaskAssignee,
      status: "تحت التنفيذ",
      isAuto: false,
    };

    setImprovementTasks((prev) => [...prev, newTask]);
    setIsAddTaskModalOpen(false);
    setNewTaskText("");
    setNewTaskAssignee("");
    setActiveIndicatorForTask(null);
  };

  // Open edit task modal
  const openEditTaskModal = (task: ImprovementTask) => {
    setEditingTask(task);
    setNewTaskAssignee(task.assignee);
    setNewTaskText(task.taskText);
    setIsEditTaskModalOpen(true);
  };

  // Save edited task
  const handleSaveEditTask = () => {
    if (!editingTask) return;

    setImprovementTasks((prev) =>
      prev.map((t) =>
        t.id === editingTask.id
          ? {
              ...t,
              assignee: newTaskAssignee,
              taskText: !editingTask.isAuto ? newTaskText : t.taskText,
            }
          : t
      )
    );
    setIsEditTaskModalOpen(false);
    setEditingTask(null);
    setNewTaskAssignee("");
    setNewTaskText("");
  };

  // Delete task (only manual)
  const handleDeleteTask = (task: ImprovementTask) => {
    if (task.isAuto) {
      toast({
        title: "غير مسموح",
        description: "لا يمكن حذف البنود التلقائية",
        variant: "destructive",
      });
      return;
    }
    setImprovementTasks((prev) => prev.filter((t) => t.id !== task.id));
  };

  // Update task status
  const handleStatusChange = (taskId: string, newStatus: "تحت التنفيذ" | "تم") => {
    setImprovementTasks((prev) =>
      prev.map((t) => (t.id === taskId ? { ...t, status: newStatus } : t))
    );
  };

  // Add team member
  const handleAddTeamMember = () => {
    if (!newMemberName.trim()) return;
    if (!teamMembers.includes(newMemberName.trim())) {
      setTeamMembers((prev) => [...prev, newMemberName.trim()]);
    }
    setNewMemberName("");
  };

  // Render improvement plan panel for an indicator
  const renderImprovementPanel = (indicatorId: string) => {
    const indicatorTasks = improvementTasks.filter((t) => t.indicatorId === indicatorId);

    return (
      <div className="mt-4 rounded-lg overflow-hidden" style={{ backgroundColor: "#e8f5f3" }}>
        <div className="p-4">
          {/* Panel Title */}
          <h4 className="text-lg font-hrsd-semibold mb-2" style={{ color: "#f5961e" }}>
            بنود التحسين
          </h4>
          <div className="h-px bg-gray-300 mb-4" />

          {indicatorTasks.length === 0 ? (
            <p className="text-sm font-hrsd text-gray-500 text-center py-6">
              لا توجد مهام تحسين مضافة
            </p>
          ) : (
            <div className="rounded-lg overflow-hidden border border-gray-200 bg-white">
              {/* Table Header */}
              <div
                className="flex items-center text-sm font-hrsd-semibold text-white"
                style={{ backgroundColor: "#148287" }}
              >
                <div className="w-16 py-3 text-center border-l border-white/20">النوع</div>
                <div className="flex-1 py-3 px-4 border-l border-white/20">المهمة</div>
                <div className="w-20 py-3 text-center border-l border-white/20">التاريخ</div>
                <div className="w-24 py-3 text-center border-l border-white/20">المسؤول</div>
                <div className="w-36 py-3 text-center">العمليات</div>
              </div>

              {/* Table Rows */}
              {indicatorTasks.map((task, index) => (
                <div
                  key={task.id}
                  className={`flex items-center text-sm ${
                    index % 2 === 0 ? "bg-white" : "bg-gray-50/50"
                  } hover:bg-gray-50 transition-colors`}
                >
                  <div className="w-16 py-3 text-center font-hrsd text-foreground border-l border-gray-100">
                    {task.type}
                  </div>
                  <div className="flex-1 py-3 px-4 font-hrsd text-foreground border-l border-gray-100 truncate">
                    {task.taskText}
                  </div>
                  <div className="w-20 py-3 text-center font-hrsd text-gray-600 border-l border-gray-100">
                    {task.date}
                  </div>
                  <div className="w-24 py-3 text-center font-hrsd text-gray-600 border-l border-gray-100">
                    {task.assignee || "—"}
                  </div>
                  <div className="w-36 py-3 flex items-center justify-center gap-1">
                    {/* Status dropdown */}
                    <div className="relative">
                      <select
                        value={task.status}
                        onChange={(e) =>
                          handleStatusChange(task.id, e.target.value as "تحت التنفيذ" | "تم")
                        }
                        className="appearance-none text-xs font-hrsd px-2 py-1 rounded border border-gray-200 bg-white pr-6"
                        style={{ color: "#148287" }}
                      >
                        <option value="تحت التنفيذ">تحت التنفيذ</option>
                        <option value="تم">تم</option>
                      </select>
                      <ChevronDown
                        className="absolute left-1 top-1/2 -translate-y-1/2 w-3 h-3 pointer-events-none"
                        style={{ color: "#148287" }}
                      />
                    </div>
                    {/* Edit button */}
                    <button
                      onClick={() => openEditTaskModal(task)}
                      className="p-1.5 rounded hover:bg-gray-100 transition-colors"
                      title="تعديل"
                    >
                      <Pencil className="w-4 h-4" style={{ color: "#148287" }} />
                    </button>
                    {/* Delete button (only for manual) */}
                    <button
                      onClick={() => handleDeleteTask(task)}
                      className={`p-1.5 rounded hover:bg-gray-100 transition-colors ${
                        task.isAuto ? "opacity-50 cursor-not-allowed" : ""
                      }`}
                      title={task.isAuto ? "لا يمكن حذف البنود التلقائية" : "حذف"}
                    >
                      <Trash2 className="w-4 h-4" style={{ color: "#148287" }} />
                    </button>
                    {/* Plus icon for auto tasks */}
                    {task.isAuto && (
                      <span className="p-1.5">
                        <Plus className="w-4 h-4" style={{ color: "#148287" }} />
                      </span>
                    )}
                  </div>
                </div>
              ))}
            </div>
          )}

          {/* Add Task Button */}
          <div className="mt-4 flex justify-end">
            <button
              onClick={() => openAddTaskModal(indicatorId)}
              className="px-6 py-2 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
              style={{ backgroundColor: "#148287" }}
            >
              إضافة مهمة رئيسية
            </button>
          </div>
        </div>
      </div>
    );
  };

  // Render evidence panel for an indicator
  const renderEvidencePanel = (indicatorId: string) => {
    const indicatorEvidence = evidenceRecords.filter((e) => e.indicatorId === indicatorId);
    
    return (
      <div className="mt-4 rounded-lg overflow-hidden" style={{ backgroundColor: "#e8f5f3" }}>
        <div className="p-4">
          {/* Panel Title */}
          <h4 className="text-lg font-hrsd-semibold mb-2" style={{ color: "#f5961e" }}>
            الشواهد
          </h4>
          <div className="h-px bg-gray-300 mb-4" />
          
          {indicatorEvidence.length === 0 ? (
            <p className="text-sm font-hrsd text-gray-500 text-center py-6">
              لا توجد شواهد مضافة
            </p>
          ) : (
            <div className="rounded-lg overflow-hidden border border-gray-200 bg-white">
              {/* Table Header */}
              <div 
                className="flex items-center text-sm font-hrsd-semibold text-white"
                style={{ backgroundColor: "#148287" }}
              >
                <div className="flex-1 py-3 px-4 border-l border-white/20">
                  الشاهد
                </div>
                <div className="w-24 py-3 text-center border-l border-white/20">
                  التاريخ
                </div>
                <div className="w-28 py-3 text-center border-l border-white/20">
                  الحالة
                </div>
                <div className="w-24 py-3 text-center">
                  العمليات
                </div>
              </div>
              
              {/* Table Rows */}
              {indicatorEvidence.map((evidence, index) => (
                <div 
                  key={evidence.id}
                  className={`flex items-center text-sm ${
                    evidence.hidden ? "opacity-50" : ""
                  } ${index % 2 === 0 ? "bg-white" : "bg-gray-50/50"}`}
                >
                  <div className="flex-1 py-3 px-4 font-hrsd text-foreground border-l border-gray-100">
                    {evidence.itemLabel} - {evidence.fileName}
                  </div>
                  <div className="w-24 py-3 text-center font-hrsd text-gray-600 border-l border-gray-100">
                    {evidence.uploadedAt}
                  </div>
                  <div className="w-28 py-3 text-center font-hrsd text-gray-600 border-l border-gray-100">
                    {evidence.status}
                  </div>
                  <div className="w-24 py-3 flex items-center justify-center gap-2">
                    <button
                      onClick={() => toggleEvidenceVisibility(evidence.id)}
                      className="p-1.5 rounded hover:bg-gray-100 transition-colors"
                      title={evidence.hidden ? "إظهار" : "إخفاء"}
                    >
                      {evidence.hidden ? (
                        <EyeOff className="w-4 h-4" style={{ color: "#148287" }} />
                      ) : (
                        <Eye className="w-4 h-4" style={{ color: "#148287" }} />
                      )}
                    </button>
                    <button
                      onClick={() => deleteEvidence(evidence.id)}
                      className="p-1.5 rounded hover:bg-gray-100 transition-colors"
                      title="حذف"
                    >
                      <Trash2 className="w-4 h-4" style={{ color: "#148287" }} />
                    </button>
                  </div>
                </div>
              ))}
            </div>
          )}
          
          {/* Add Evidence Button */}
          <div className="mt-4 flex justify-start">
            <button
              onClick={() => generalEvidenceInputRef.current[indicatorId]?.click()}
              className="px-6 py-2 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
              style={{ backgroundColor: "#148287" }}
            >
              إضافة شاهد
            </button>
            <input
              type="file"
              ref={(el) => (generalEvidenceInputRef.current[indicatorId] = el)}
              onChange={(e) => handleGeneralEvidenceUpload(indicatorId, e)}
              className="hidden"
            />
          </div>
        </div>
      </div>
    );
  };

  // Render notes panel for an indicator
  const renderNotesPanel = (indicatorId: string) => {
    const indicatorNotes = notes.filter((n) => n.indicatorId === indicatorId);

    return (
      <div className="mt-4 rounded-lg overflow-hidden" style={{ backgroundColor: "#e8f5f3" }}>
        <div className="p-4">
          {/* Panel Title */}
          <h4 className="text-lg font-hrsd-semibold mb-2" style={{ color: "#f5961e" }}>
            ملاحظات التقييم
          </h4>
          <div className="h-px bg-gray-300 mb-4" />

          {/* Notes Table */}
          <div className="rounded-lg overflow-hidden border border-gray-200 bg-white mb-4">
            {/* Table Header */}
            <div
              className="flex items-center text-sm font-hrsd-semibold text-white"
              style={{ backgroundColor: "#148287" }}
            >
              <div className="flex-1 py-3 px-4 border-l border-white/20">
                الملاحظة
              </div>
              <div className="w-24 py-3 text-center border-l border-white/20">
                التاريخ
              </div>
              <div className="w-24 py-3 text-center">
                المصدر
              </div>
            </div>

            {/* Table Rows */}
            {indicatorNotes.length === 0 ? (
              <div className="py-6 text-center text-sm font-hrsd text-gray-500">
                لا توجد ملاحظات مضافة
              </div>
            ) : (
              indicatorNotes.map((note, index) => (
                <div
                  key={note.id}
                  className={`flex items-center text-sm ${
                    index % 2 === 0 ? "bg-white" : "bg-gray-50/50"
                  }`}
                >
                  <div className="flex-1 py-3 px-4 font-hrsd text-foreground border-l border-gray-100">
                    {note.text}
                  </div>
                  <div className="w-24 py-3 text-center font-hrsd text-gray-600 border-l border-gray-100">
                    {note.date}
                  </div>
                  <div className="w-24 py-3 text-center font-hrsd text-gray-600">
                    {note.source}
                  </div>
                </div>
              ))
            )}
          </div>

          {/* Add Note Textarea */}
          <div className="bg-white rounded-lg border border-gray-200 p-4">
            <textarea
              value={noteInputs[indicatorId] || ""}
              onChange={(e) =>
                setNoteInputs((prev) => ({ ...prev, [indicatorId]: e.target.value }))
              }
              placeholder="إضافة الملاحظة"
              className="w-full min-h-[120px] text-sm font-hrsd text-foreground placeholder:text-gray-400 focus:outline-none resize-none"
              dir="rtl"
            />
          </div>

          {/* Save Button */}
          <div className="mt-4 flex justify-end">
            <button
              onClick={() => handleSaveNote(indicatorId)}
              className="px-8 py-2 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
              style={{ backgroundColor: "#148287" }}
            >
              حفظ
            </button>
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="min-h-screen flex flex-col bg-white">
      <Header />
      
      <main className="flex-1 pt-24 pb-12">
        {/* Side Patterns - Curved Lines */}
        <div 
          className="fixed left-0 top-0 bottom-0 w-24 pointer-events-none z-0"
          style={{
            backgroundImage: `url("data:image/svg+xml,%3Csvg width='100' height='400' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M 80 0 Q 20 100 80 200 Q 20 300 80 400' stroke='%23148287' stroke-width='1' fill='none' opacity='0.15'/%3E%3Cpath d='M 60 0 Q 0 100 60 200 Q 0 300 60 400' stroke='%23148287' stroke-width='1' fill='none' opacity='0.12'/%3E%3Cpath d='M 40 0 Q -20 100 40 200 Q -20 300 40 400' stroke='%23148287' stroke-width='1' fill='none' opacity='0.08'/%3E%3C/svg%3E")`,
            backgroundRepeat: 'repeat-y',
            backgroundPosition: 'left center',
          }}
        />
        <div 
          className="fixed right-0 top-0 bottom-0 w-24 pointer-events-none z-0"
          style={{
            backgroundImage: `url("data:image/svg+xml,%3Csvg width='100' height='400' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M 20 0 Q 80 100 20 200 Q 80 300 20 400' stroke='%23148287' stroke-width='1' fill='none' opacity='0.15'/%3E%3Cpath d='M 40 0 Q 100 100 40 200 Q 100 300 40 400' stroke='%23148287' stroke-width='1' fill='none' opacity='0.12'/%3E%3Cpath d='M 60 0 Q 120 100 60 200 Q 120 300 60 400' stroke='%23148287' stroke-width='1' fill='none' opacity='0.08'/%3E%3C/svg%3E")`,
            backgroundRepeat: 'repeat-y',
            backgroundPosition: 'right center',
          }}
        />

        <div className="container mx-auto px-4 relative z-10">
          {/* Constrained width container */}
          <div className="max-w-5xl mx-auto">
            {/* Breadcrumb */}
            <nav className="flex items-center gap-2 text-sm font-hrsd mb-3">
              <Link to="/dashboard" className="text-primary hover:underline transition-colors">
                العودة إلى لوحة التحكم
              </Link>
              <span className="text-primary">&gt;</span>
              <span className="text-primary font-hrsd-semibold">مؤشرات التقييم الفني</span>
            </nav>
            
            {/* Green horizontal line */}
            <div className="h-0.5 bg-primary w-full mb-6" />

            {/* Course Title (Orange) */}
            <h1 
              className="text-2xl font-hrsd-bold mb-6"
              style={{ color: "#f5961e" }}
            >
              مساق: {currentCourse.name}
            </h1>

            {/* White content container */}
            <div className="bg-white rounded-lg shadow-md p-6 border border-border">
              {/* Criteria Loop */}
              {currentCourse.criteria.map((criterion) => (
                <div key={criterion.id} className="mb-8 last:mb-0">
                  {/* Criterion Header */}
                  <div className="flex items-center gap-3 mb-6">
                    {/* Circle with number */}
                    <div 
                      className="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0"
                      style={{ backgroundColor: "#e8f5f3" }}
                    >
                      <span className="text-sm font-hrsd-bold" style={{ color: "#f5961e" }}>
                        {criterion.number}
                      </span>
                    </div>
                    {/* Criterion name badge */}
                    <div 
                      className="px-4 py-2 rounded-md"
                      style={{ backgroundColor: "#e8f5f3" }}
                    >
                      <span className="text-sm font-hrsd-semibold" style={{ color: "#f5961e" }}>
                        {criterion.name}
                      </span>
                    </div>
                  </div>

                  {/* Indicators Loop */}
                  {criterion.indicators.map((indicator) => (
                    <div 
                      key={indicator.id} 
                      className="mb-6 last:mb-0 bg-white rounded-lg shadow-md border border-border p-5"
                    >
                      {/* Indicator Title (Blue) */}
                      <h3 
                        className="text-base font-hrsd-medium mb-4"
                        style={{ color: "#148287" }}
                      >
                        {indicator.title}
                      </h3>

                      {/* Verification Items Table */}
                      <div className="border border-border rounded-lg overflow-hidden mb-4">
                        {/* Table Header */}
                        <div 
                          className="flex items-center text-sm font-hrsd-semibold text-white"
                          style={{ backgroundColor: "#148287" }}
                        >
                          <div className="w-16 py-3 text-center border-l border-white/20">
                            اختر
                          </div>
                          <div className="flex-1 py-3 px-4 border-l border-white/20">
                            بنود التحقق
                          </div>
                          <div className="w-20 py-3 text-center">
                            الشواهد
                          </div>
                        </div>

                        {/* Table Rows */}
                        {indicator.items.map((item, itemIndex) => (
                          <div 
                            key={item.id}
                            className={`flex items-center transition-all duration-200 hover:bg-gray-50 ${
                              itemIndex % 2 === 0 ? "bg-white" : "bg-gray-50/50"
                            }`}
                          >
                            {/* Checkbox cell */}
                            <div className="w-16 py-3 flex justify-center border-l border-border">
                              <Checkbox
                                id={item.id}
                                checked={checkedItems[item.id] || false}
                                onCheckedChange={(checked) => handleCheckChange(item.id, checked as boolean)}
                                className="data-[state=checked]:bg-primary data-[state=checked]:border-primary"
                              />
                            </div>
                            
                            {/* Item text cell */}
                            <div className="flex-1 py-3 px-4 text-sm font-hrsd text-foreground">
                              {item.text}
                            </div>

                            {/* Upload button cell (الشواهد column) */}
                            <div className="w-20 py-3 flex justify-center">
                              <button
                                onClick={() => handleUploadClick(item.id)}
                                className={`w-8 h-8 rounded flex items-center justify-center transition-all duration-200 hover:bg-gray-200 ${
                                  uploadedFiles[item.id] ? "bg-green-100" : "bg-gray-100"
                                }`}
                                title="رفع الشاهد"
                              >
                                {uploadedFiles[item.id] ? (
                                  <Check className="w-4 h-4 text-green-600" />
                                ) : (
                                  <Upload className="w-4 h-4 text-gray-600" />
                                )}
                              </button>
                              <input
                                type="file"
                                ref={(el) => (fileInputRefs.current[item.id] = el)}
                                onChange={(e) => handleFileChange(item.id, indicator.id, itemIndex, e)}
                                className="hidden"
                              />
                            </div>
                          </div>
                        ))}
                      </div>

                      {/* Indicator Actions Row */}
                      <div className="flex items-center justify-between mb-4">
                        {/* Right side - Calculate button (GREEN) */}
                        <button
                          onClick={() => calculateIndicatorResult(indicator)}
                          className="flex items-center gap-2 px-6 py-2 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
                          style={{ backgroundColor: "#22c55e" }}
                        >
                          احتساب نتيجة المؤشر
                        </button>

                        {/* Left side - Result badge */}
                        <div 
                          className="px-4 py-2 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200"
                          style={{ 
                            backgroundColor: getResultColor(indicatorResults[indicator.id] || "pending"),
                          }}
                        >
                          {getResultLabel(indicatorResults[indicator.id] || "pending")}
                        </div>
                      </div>

                      {/* Thin grey divider line */}
                      <div className="h-px bg-gray-200 mb-4" />

                      {/* Bottom Action Buttons (3 buttons with active state) */}
                      <div className="flex items-center gap-4">
                        <button
                          onClick={() => handleButtonClick(indicator.id, "plan")}
                          className="flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
                          style={{ 
                            backgroundColor: activeButtons[indicator.id] === "plan" ? "#f5961e" : "#148287" 
                          }}
                        >
                          <FileText className="w-4 h-4" />
                          خطة التحسين
                          {getImprovementTasksCount(indicator.id) > 0 && (
                            <span className="bg-white/20 rounded-full px-2 py-0.5 text-xs">
                              {getImprovementTasksCount(indicator.id)}
                            </span>
                          )}
                        </button>
                        <button
                          onClick={() => handleButtonClick(indicator.id, "evidence")}
                          className="flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
                          style={{ 
                            backgroundColor: activeButtons[indicator.id] === "evidence" ? "#f5961e" : "#148287" 
                          }}
                        >
                          <Eye className="w-4 h-4" />
                          الشواهد
                          {getEvidenceCount(indicator.id) > 0 && (
                            <span className="bg-white/20 rounded-full px-2 py-0.5 text-xs">
                              {getEvidenceCount(indicator.id)}
                            </span>
                          )}
                        </button>
                        <button
                          onClick={() => handleButtonClick(indicator.id, "notes")}
                          className="flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
                          style={{ 
                            backgroundColor: activeButtons[indicator.id] === "notes" ? "#f5961e" : "#148287" 
                          }}
                        >
                          <MessageSquare className="w-4 h-4" />
                          الملاحظات
                          {getNotesCount(indicator.id) > 0 && (
                            <span className="bg-white/20 rounded-full px-2 py-0.5 text-xs">
                              {getNotesCount(indicator.id)}
                            </span>
                          )}
                        </button>
                      </div>

                      {/* Tab Content: خطة التحسين panel */}
                      {activeButtons[indicator.id] === "plan" && renderImprovementPanel(indicator.id)}

                      {/* Tab Content: الشواهد panel */}
                      {activeButtons[indicator.id] === "evidence" && renderEvidencePanel(indicator.id)}

                      {/* Tab Content: الملاحظات panel */}
                      {activeButtons[indicator.id] === "notes" && renderNotesPanel(indicator.id)}
                    </div>
                  ))}
                </div>
              ))}
            </div>
          </div>
        </div>
      </main>

      {/* Add Task Modal */}
      <Dialog open={isAddTaskModalOpen} onOpenChange={setIsAddTaskModalOpen}>
        <DialogContent className="sm:max-w-md bg-white" dir="rtl">
          <DialogHeader>
            <DialogTitle className="font-hrsd-semibold" style={{ color: "#148287" }}>
              إضافة مهمة رئيسية
            </DialogTitle>
          </DialogHeader>
          <div className="space-y-4 mt-4">
            {/* Task text */}
            <div>
              <label className="text-sm font-hrsd-medium text-foreground mb-1 block">
                المهمة
              </label>
              <textarea
                value={newTaskText}
                onChange={(e) => setNewTaskText(e.target.value)}
                placeholder="أدخل وصف المهمة..."
                className="w-full border border-border rounded-md p-3 text-sm font-hrsd min-h-[100px] focus:outline-none focus:ring-2 focus:ring-primary/20"
              />
            </div>

            {/* Assignee */}
            <div>
              <label className="text-sm font-hrsd-medium text-foreground mb-1 block">
                المسؤول
              </label>
              <div className="flex gap-2">
                <select
                  value={newTaskAssignee}
                  onChange={(e) => setNewTaskAssignee(e.target.value)}
                  className="flex-1 border border-border rounded-md p-2 text-sm font-hrsd focus:outline-none focus:ring-2 focus:ring-primary/20 bg-white"
                >
                  <option value="">— اختر المسؤول —</option>
                  {teamMembers.map((member) => (
                    <option key={member} value={member}>
                      {member}
                    </option>
                  ))}
                </select>
              </div>
              {/* Add new member */}
              <div className="flex gap-2 mt-2">
                <input
                  type="text"
                  value={newMemberName}
                  onChange={(e) => setNewMemberName(e.target.value)}
                  placeholder="إضافة عضو جديد..."
                  className="flex-1 border border-border rounded-md p-2 text-sm font-hrsd focus:outline-none focus:ring-2 focus:ring-primary/20"
                />
                <button
                  onClick={handleAddTeamMember}
                  className="px-3 py-2 rounded-md text-sm font-hrsd-medium text-white"
                  style={{ backgroundColor: "#148287" }}
                >
                  إضافة
                </button>
              </div>
            </div>

            {/* Action buttons */}
            <div className="flex gap-3 pt-4">
              <button
                onClick={handleAddTask}
                className="flex-1 px-4 py-2 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
                style={{ backgroundColor: "#148287" }}
              >
                حفظ المهمة
              </button>
              <button
                onClick={() => setIsAddTaskModalOpen(false)}
                className="flex-1 px-4 py-2 rounded-md text-sm font-hrsd-medium border border-border text-foreground hover:bg-gray-50 transition-colors"
              >
                إلغاء
              </button>
            </div>
          </div>
        </DialogContent>
      </Dialog>

      {/* Edit Task Modal */}
      <Dialog open={isEditTaskModalOpen} onOpenChange={setIsEditTaskModalOpen}>
        <DialogContent className="sm:max-w-md bg-white" dir="rtl">
          <DialogHeader>
            <DialogTitle className="font-hrsd-semibold" style={{ color: "#148287" }}>
              تعديل المهمة
            </DialogTitle>
          </DialogHeader>
          <div className="space-y-4 mt-4">
            {/* Task text (only editable for manual) */}
            {!editingTask?.isAuto && (
              <div>
                <label className="text-sm font-hrsd-medium text-foreground mb-1 block">
                  المهمة
                </label>
                <textarea
                  value={newTaskText}
                  onChange={(e) => setNewTaskText(e.target.value)}
                  className="w-full border border-border rounded-md p-3 text-sm font-hrsd min-h-[100px] focus:outline-none focus:ring-2 focus:ring-primary/20"
                />
              </div>
            )}

            {/* Show task text for auto (read-only) */}
            {editingTask?.isAuto && (
              <div>
                <label className="text-sm font-hrsd-medium text-foreground mb-1 block">
                  المهمة (تلقائية)
                </label>
                <div className="w-full border border-border rounded-md p-3 text-sm font-hrsd bg-gray-50 text-gray-600">
                  {editingTask.taskText}
                </div>
              </div>
            )}

            {/* Assignee */}
            <div>
              <label className="text-sm font-hrsd-medium text-foreground mb-1 block">
                المسؤول
              </label>
              <div className="flex gap-2">
                <select
                  value={newTaskAssignee}
                  onChange={(e) => setNewTaskAssignee(e.target.value)}
                  className="flex-1 border border-border rounded-md p-2 text-sm font-hrsd focus:outline-none focus:ring-2 focus:ring-primary/20 bg-white"
                >
                  <option value="">— اختر المسؤول —</option>
                  {teamMembers.map((member) => (
                    <option key={member} value={member}>
                      {member}
                    </option>
                  ))}
                </select>
              </div>
              {/* Add new member */}
              <div className="flex gap-2 mt-2">
                <input
                  type="text"
                  value={newMemberName}
                  onChange={(e) => setNewMemberName(e.target.value)}
                  placeholder="إضافة عضو جديد..."
                  className="flex-1 border border-border rounded-md p-2 text-sm font-hrsd focus:outline-none focus:ring-2 focus:ring-primary/20"
                />
                <button
                  onClick={handleAddTeamMember}
                  className="px-3 py-2 rounded-md text-sm font-hrsd-medium text-white"
                  style={{ backgroundColor: "#148287" }}
                >
                  إضافة
                </button>
              </div>
            </div>

            {/* Action buttons */}
            <div className="flex gap-3 pt-4">
              <button
                onClick={handleSaveEditTask}
                className="flex-1 px-4 py-2 rounded-md text-sm font-hrsd-medium text-white transition-all duration-200 hover:shadow-md hover:brightness-110"
                style={{ backgroundColor: "#148287" }}
              >
                حفظ التعديلات
              </button>
              <button
                onClick={() => {
                  setIsEditTaskModalOpen(false);
                  setEditingTask(null);
                }}
                className="flex-1 px-4 py-2 rounded-md text-sm font-hrsd-medium border border-border text-foreground hover:bg-gray-50 transition-colors"
              >
                إلغاء
              </button>
            </div>
          </div>
        </DialogContent>
      </Dialog>

      <Footer />
    </div>
  );
};

export default TechnicalEvaluationIndicators;
